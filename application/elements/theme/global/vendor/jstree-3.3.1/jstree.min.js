
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module!=="undefined"&&module.exports){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(d,e){
/*!
 * jsTree 3.3.1
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */
/*!
 * if using jslint please allow for the jQuery global and use following options:
 * jslint: loopfunc: true, browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
if(d.jstree){return}var m=0,b=false,s=false,l=false,p=[],h=d("script:last").attr("src"),o=window.document,f=o.createElement("LI"),k,i;f.setAttribute("role","treeitem");k=o.createElement("I");k.className="jstree-icon jstree-ocl";k.setAttribute("role","presentation");f.appendChild(k);k=o.createElement("A");k.className="jstree-anchor";k.setAttribute("href","#");k.setAttribute("tabindex","-1");i=o.createElement("I");i.className="jstree-icon jstree-themeicon";i.setAttribute("role","presentation");k.appendChild(i);f.appendChild(k);k=i=null;d.jstree={version:"3.3.1",defaults:{plugins:[]},plugins:{},path:h&&h.indexOf("/")!==-1?h.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"};d.jstree.create=function(w,t){var v=new d.jstree.core(++m),u=t;t=d.extend(true,{},d.jstree.defaults,t);if(u&&u.plugins){t.plugins=u.plugins}d.each(t.plugins,function(y,x){if(y!=="core"){v=v.plugin(x,t[x])}});d(w).data("jstree",v);v.init(w,t);return v};d.jstree.destroy=function(){d(".jstree:jstree").jstree("destroy");d(o).off(".jstree")};d.jstree.core=function(t){this._id=t;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:false,dots:false,icons:false},selected:[],last_error:{},working:false,worker_queue:[],focused:null}}};d.jstree.reference=function(v){var t=null,u=null;if(v&&v.id&&(!v.tagName||!v.nodeType)){v=v.id}if(!u||!u.length){try{u=d(v)}catch(w){}}if(!u||!u.length){try{u=d("#"+v.replace(d.jstree.idregex,"\\$&"))}catch(w){}}if(u&&u.length&&(u=u.closest(".jstree")).length&&(u=u.data("jstree"))){t=u}else{d(".jstree").each(function(){var x=d(this).data("jstree");if(x&&x._model.data[v]){t=x;return false}})}return t};d.fn.jstree=function(u){var w=(typeof u==="string"),v=Array.prototype.slice.call(arguments,1),t=null;if(u===true&&!this.length){return false}this.each(function(){var x=d.jstree.reference(this),y=w&&x?x[u]:null;t=w&&y?y.apply(x,v):null;if(!x&&!w&&(u===e||d.isPlainObject(u))){d.jstree.create(this,u)}if((x&&!w)||u===true){t=x||false}if(t!==null&&t!==e){return false}});return t!==null&&t!==e?t:this};d.expr[":"].jstree=d.expr.createPseudo(function(t){return function(u){return d(u).hasClass("jstree")&&d(u).data("jstree")!==e}});d.jstree.defaults.core={data:false,strings:false,check_callback:false,error:d.noop,animation:200,multiple:true,themes:{name:false,url:false,dir:false,dots:true,icons:true,stripes:false,variant:false,responsive:false},expand_selected_onload:true,worker:true,force_text:false,dblclick_toggle:true};d.jstree.core.prototype={plugin:function(v,u){var t=d.jstree.plugins[v];if(t){this._data[v]={};t.prototype=this;return new t(u,this)}return this},init:function(u,t){this._model={data:{},changed:[],force_full_redraw:false,redraw_timeout:false,default_state:{loaded:true,opened:false,selected:false,disabled:false}};this._model.data[d.jstree.root]={id:d.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:false}};this.element=d(u).addClass("jstree jstree-"+this._id);this.settings=t;this._data.core.ready=false;this._data.core.loaded=false;this._data.core.rtl=(this.element.css("direction")==="rtl");this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");if(this.settings.core.multiple){this.element.attr("aria-multiselectable",true)}if(!this.element.attr("tabindex")){this.element.attr("tabindex","0")}this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(true);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().height()||24;this.trigger("loading");this.load_node(d.jstree.root)},destroy:function(t){if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(u){}}if(!t){this.element.empty()}this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function(){var u="",t=null,v=0;this.element.on("dblclick.jstree",function(x){if(x.target.tagName&&x.target.tagName.toLowerCase()==="input"){return true}if(o.selection&&o.selection.empty){o.selection.empty()}else{if(window.getSelection){var w=window.getSelection();try{w.removeAllRanges();w.collapse()}catch(y){}}}}).on("mousedown.jstree",d.proxy(function(w){if(w.target===this.element[0]){w.preventDefault();v=+(new Date())}},this)).on("mousedown.jstree",".jstree-ocl",function(w){w.preventDefault()}).on("click.jstree",".jstree-ocl",d.proxy(function(w){this.toggle_node(w.target)},this)).on("dblclick.jstree",".jstree-anchor",d.proxy(function(w){if(w.target.tagName&&w.target.tagName.toLowerCase()==="input"){return true}if(this.settings.core.dblclick_toggle){this.toggle_node(w.target)}},this)).on("click.jstree",".jstree-anchor",d.proxy(function(w){w.preventDefault();if(w.currentTarget!==o.activeElement){d(w.currentTarget).focus()}this.activate_node(w.currentTarget,w)},this)).on("keydown.jstree",".jstree-anchor",d.proxy(function(w){if(w.target.tagName&&w.target.tagName.toLowerCase()==="input"){return true}if(w.which!==32&&w.which!==13&&(w.shiftKey||w.ctrlKey||w.altKey||w.metaKey)){return true}var x=null;if(this._data.core.rtl){if(w.which===37){w.which=39}else{if(w.which===39){w.which=37}}}switch(w.which){case 32:if(w.ctrlKey){w.type="click";d(w.currentTarget).trigger(w)}break;case 13:w.type="click";d(w.currentTarget).trigger(w);break;case 37:w.preventDefault();if(this.is_open(w.currentTarget)){this.close_node(w.currentTarget)}else{x=this.get_parent(w.currentTarget);if(x&&x.id!==d.jstree.root){this.get_node(x,true).children(".jstree-anchor").focus()}}break;case 38:w.preventDefault();x=this.get_prev_dom(w.currentTarget);if(x&&x.length){x.children(".jstree-anchor").focus()}break;case 39:w.preventDefault();if(this.is_closed(w.currentTarget)){this.open_node(w.currentTarget,function(y){this.get_node(y,true).children(".jstree-anchor").focus()})}else{if(this.is_open(w.currentTarget)){x=this.get_node(w.currentTarget,true).children(".jstree-children")[0];if(x){d(this._firstChild(x)).children(".jstree-anchor").focus()}}}break;case 40:w.preventDefault();x=this.get_next_dom(w.currentTarget);if(x&&x.length){x.children(".jstree-anchor").focus()}break;case 106:this.open_all();break;case 36:w.preventDefault();x=this._firstChild(this.get_container_ul()[0]);if(x){d(x).children(".jstree-anchor").filter(":visible").focus()}break;case 35:w.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:w.preventDefault();this.edit(w.currentTarget);break;default:break;
/*!
							// delete
							case 46:
								e.preventDefault();
								o = this.get_node(e.currentTarget);
								if(o && o.id && o.id !== $.jstree.root) {
									o = this.is_selected(o) ? this.get_selected() : o;
									this.delete_node(o);
								}
								break;

							*/
}},this)).on("load_node.jstree",d.proxy(function(x,w){if(w.status){if(w.node.id===d.jstree.root&&!this._data.core.loaded){this._data.core.loaded=true;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.trigger("loaded")}if(!this._data.core.ready){setTimeout(d.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){this._data.core.ready=true;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var A=[],z,y;for(z=0,y=this._data.core.selected.length;z<y;z++){A=A.concat(this._model.data[this._data.core.selected[z]].parents)}A=d.vakata.array_unique(A);for(z=0,y=A.length;z<y;z++){this.open_node(A[z],false,0)}}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0)}}},this)).on("keypress.jstree",d.proxy(function(A){if(A.target.tagName&&A.target.tagName.toLowerCase()==="input"){return true}if(t){clearTimeout(t)}t=setTimeout(function(){u=""},500);var y=String.fromCharCode(A.which).toLowerCase(),x=this.element.find(".jstree-anchor").filter(":visible"),z=x.index(o.activeElement)||0,w=false;u+=y;if(u.length>1){x.slice(z).each(d.proxy(function(C,B){if(d(B).text().toLowerCase().indexOf(u)===0){d(B).focus();w=true;return false}},this));if(w){return}x.slice(0,z).each(d.proxy(function(C,B){if(d(B).text().toLowerCase().indexOf(u)===0){d(B).focus();w=true;return false}},this));if(w){return}}if(new RegExp("^"+y.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(u)){x.slice(z+1).each(d.proxy(function(C,B){if(d(B).text().toLowerCase().charAt(0)===y){d(B).focus();w=true;return false}},this));if(w){return}x.slice(0,z+1).each(d.proxy(function(C,B){if(d(B).text().toLowerCase().charAt(0)===y){d(B).focus();w=true;return false}},this));if(w){return}}},this)).on("init.jstree",d.proxy(function(){var w=this.settings.core.themes;this._data.core.themes.dots=w.dots;this._data.core.themes.stripes=w.stripes;this._data.core.themes.icons=w.icons;this.set_theme(w.name||"default",w.url);this.set_theme_variant(w.variant)},this)).on("loading.jstree",d.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",d.proxy(function(w){this._data.core.focused=null;d(w.currentTarget).filter(".jstree-hovered").mouseleave();this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",d.proxy(function(x){var w=this.get_node(x.currentTarget);if(w&&w.id){this._data.core.focused=w.id}this.element.find(".jstree-hovered").not(x.currentTarget).mouseleave();d(x.currentTarget).mouseenter();this.element.attr("tabindex","-1")},this)).on("focus.jstree",d.proxy(function(){if(+(new Date())-v>500&&!this._data.core.focused){v=0;var w=this.get_node(this.element.attr("aria-activedescendant"),true);if(w){w.find("> .jstree-anchor").focus()}}},this)).on("mouseenter.jstree",".jstree-anchor",d.proxy(function(w){this.hover_node(w.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",d.proxy(function(w){this.dehover_node(w.currentTarget)},this))},unbind:function(){this.element.off(".jstree");d(o).off(".jstree-"+this._id)},trigger:function(t,u){if(!u){u={}}u.instance=this;this.element.triggerHandler(t.replace(".jstree","")+".jstree",u)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(u){var t=this.settings.core.strings;if(d.isFunction(t)){return t.call(this,u)}if(t&&t[u]){return t[u]}return u},_firstChild:function(t){t=t?t.firstChild:null;while(t!==null&&t.nodeType!==1){t=t.nextSibling}return t},_nextSibling:function(t){t=t?t.nextSibling:null;while(t!==null&&t.nodeType!==1){t=t.nextSibling}return t},_previousSibling:function(t){t=t?t.previousSibling:null;while(t!==null&&t.nodeType!==1){t=t.previousSibling}return t},get_node:function(v,t){if(v&&v.id){v=v.id}var w;try{if(this._model.data[v]){v=this._model.data[v]}else{if(typeof v==="string"&&this._model.data[v.replace(/^#/,"")]){v=this._model.data[v.replace(/^#/,"")]}else{if(typeof v==="string"&&(w=d("#"+v.replace(d.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[w.closest(".jstree-node").attr("id")]){v=this._model.data[w.closest(".jstree-node").attr("id")]}else{if((w=d(v,this.element)).length&&this._model.data[w.closest(".jstree-node").attr("id")]){v=this._model.data[w.closest(".jstree-node").attr("id")]}else{if((w=d(v,this.element)).length&&w.hasClass("jstree")){v=this._model.data[d.jstree.root]}else{return false}}}}}if(t){v=v.id===d.jstree.root?this.element:d("#"+v.id.replace(d.jstree.idregex,"\\$&"),this.element)}return v}catch(u){return false}},get_path:function(y,w,v){y=y.parents?y:this.get_node(y);if(!y||y.id===d.jstree.root||!y.parents){return false}var u,t,x=[];x.push(v?y.id:y.text);for(u=0,t=y.parents.length;u<t;u++){x.push(v?y.parents[u]:this.get_text(y.parents[u]))}x=x.reverse().slice(1);return w?x.join(w):x},get_next_dom:function(v,t){var u;v=this.get_node(v,true);if(v[0]===this.element[0]){u=this._firstChild(this.get_container_ul()[0]);while(u&&u.offsetHeight===0){u=this._nextSibling(u)}return u?d(u):false}if(!v||!v.length){return false}if(t){u=v[0];do{u=this._nextSibling(u)}while(u&&u.offsetHeight===0);return u?d(u):false}if(v.hasClass("jstree-open")){u=this._firstChild(v.children(".jstree-children")[0]);while(u&&u.offsetHeight===0){u=this._nextSibling(u)}if(u!==null){return d(u)}}u=v[0];do{u=this._nextSibling(u)}while(u&&u.offsetHeight===0);if(u!==null){return d(u)}return v.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(v,t){var u;v=this.get_node(v,true);if(v[0]===this.element[0]){u=this.get_container_ul()[0].lastChild;while(u&&u.offsetHeight===0){u=this._previousSibling(u)}return u?d(u):false}if(!v||!v.length){return false}if(t){u=v[0];do{u=this._previousSibling(u)}while(u&&u.offsetHeight===0);return u?d(u):false}u=v[0];do{u=this._previousSibling(u)}while(u&&u.offsetHeight===0);if(u!==null){v=d(u);while(v.hasClass("jstree-open")){v=v.children(".jstree-children").first().children(".jstree-node:visible:last")}return v}u=v[0].parentNode.parentNode;return u&&u.className&&u.className.indexOf("jstree-node")!==-1?d(u):false},get_parent:function(t){t=this.get_node(t);if(!t||t.id===d.jstree.root){return false}return t.parent},get_children_dom:function(t){t=this.get_node(t,true);if(t[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")}if(!t||!t.length){return false}return t.children(".jstree-children").children(".jstree-node")},is_parent:function(t){t=this.get_node(t);return t&&(t.state.loaded===false||t.children.length>0)},is_loaded:function(t){t=this.get_node(t);return t&&t.state.loaded},is_loading:function(t){t=this.get_node(t);return t&&t.state&&t.state.loading},is_open:function(t){t=this.get_node(t);return t&&t.state.opened},is_closed:function(t){t=this.get_node(t);return t&&this.is_parent(t)&&!t.state.opened},is_leaf:function(t){return !this.is_parent(t)},load_node:function(x,z){var u,t,w,v,y;if(d.isArray(x)){this._load_nodes(x.slice(),z);return true}x=this.get_node(x);if(!x){if(z){z.call(this,x,false)}return false}if(x.state.loaded){x.state.loaded=false;for(w=0,v=x.parents.length;w<v;w++){this._model.data[x.parents[w]].children_d=d.vakata.array_filter(this._model.data[x.parents[w]].children_d,function(A){return d.inArray(A,x.children_d)===-1})}for(u=0,t=x.children_d.length;u<t;u++){if(this._model.data[x.children_d[u]].state.selected){y=true}delete this._model.data[x.children_d[u]]}if(y){this._data.core.selected=d.vakata.array_filter(this._data.core.selected,function(A){return d.inArray(A,x.children_d)===-1})}x.children=[];x.children_d=[];if(y){this.trigger("changed",{action:"load_node",node:x,selected:this._data.core.selected})}}x.state.failed=false;x.state.loading=true;this.get_node(x,true).addClass("jstree-loading").attr("aria-busy",true);this._load_node(x,d.proxy(function(B){x=this._model.data[x.id];x.state.loading=false;x.state.loaded=B;x.state.failed=!x.state.loaded;var F=this.get_node(x,true),E=0,C=0,A=this._model.data,D=false;for(E=0,C=x.children.length;E<C;E++){if(A[x.children[E]]&&!A[x.children[E]].state.hidden){D=true;break}}if(x.state.loaded&&F&&F.length){F.removeClass("jstree-closed jstree-open jstree-leaf");if(!D){F.addClass("jstree-leaf")}else{if(x.id!=="#"){F.addClass(x.state.opened?"jstree-open":"jstree-closed")}}}F.removeClass("jstree-loading").attr("aria-busy",false);this.trigger("load_node",{node:x,status:B});if(z){z.call(this,x,B)}},this));return true},_load_nodes:function(u,C,B,y){var t=true,A=function(){this._load_nodes(u,C,true)},v=this._model.data,z,w,x=[];for(z=0,w=u.length;z<w;z++){if(v[u[z]]&&((!v[u[z]].state.loaded&&!v[u[z]].state.failed)||(!B&&y))){if(!this.is_loading(u[z])){this.load_node(u[z],A)}t=false}}if(t){for(z=0,w=u.length;z<w;z++){if(v[u[z]]&&v[u[z]].state.loaded){x.push(u[z])}}if(C&&!C.done){C.call(this,x);C.done=true}}},load_all:function(x,z){if(!x){x=d.jstree.root}x=this.get_node(x);if(!x){return false}var w=[],t=this._model.data,y=t[x.id].children_d,v,u;if(x.state&&!x.state.loaded){w.push(x.id)}for(v=0,u=y.length;v<u;v++){if(t[y[v]]&&t[y[v]].state&&!t[y[v]].state.loaded){w.push(y[v])}}if(w.length){this._load_nodes(w,function(){this.load_all(x,z)})}else{if(z){z.call(this,x)}this.trigger("load_all",{node:x})}},_load_node:function(w,x){var v=this.settings.core.data,u;if(!v){if(w.id===d.jstree.root){return this._append_html_data(w,this._data.core.original_container_html.clone(true),function(t){x.call(this,t)})}else{return x.call(this,false)}}if(d.isFunction(v)){return v.call(this,w,d.proxy(function(t){if(t===false){x.call(this,false)}else{this[typeof t==="string"?"_append_html_data":"_append_json_data"](w,typeof t==="string"?d(d.parseHTML(t)).filter(function(){return this.nodeType!==3}):t,function(y){x.call(this,y)})}},this))}if(typeof v==="object"){if(v.url){v=d.extend(true,{},v);if(d.isFunction(v.url)){v.url=v.url.call(this,w)}if(d.isFunction(v.data)){v.data=v.data.call(this,w)}return d.ajax(v).done(d.proxy(function(B,z,y){var A=y.getResponseHeader("Content-Type");if((A&&A.indexOf("json")!==-1)||typeof B==="object"){return this._append_json_data(w,B,function(t){x.call(this,t)})}if((A&&A.indexOf("html")!==-1)||typeof B==="string"){return this._append_html_data(w,d(d.parseHTML(B)).filter(function(){return this.nodeType!==3}),function(t){x.call(this,t)})}this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:w.id,xhr:y})};this.settings.core.error.call(this,this._data.core.last_error);return x.call(this,false)},this)).fail(d.proxy(function(t){x.call(this,false);this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:w.id,xhr:t})};this.settings.core.error.call(this,this._data.core.last_error)},this))}u=(d.isArray(v)||d.isPlainObject(v))?JSON.parse(JSON.stringify(v)):v;if(w.id===d.jstree.root){return this._append_json_data(w,u,function(t){x.call(this,t)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:w.id})};this.settings.core.error.call(this,this._data.core.last_error);return x.call(this,false)}}if(typeof v==="string"){if(w.id===d.jstree.root){return this._append_html_data(w,d(d.parseHTML(v)).filter(function(){return this.nodeType!==3}),function(t){x.call(this,t)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:w.id})};this.settings.core.error.call(this,this._data.core.last_error);return x.call(this,false)}}return x.call(this,false)},_node_changed:function(t){t=this.get_node(t);if(t){this._model.changed.push(t.id)}},_append_html_data:function(x,A,v){x=this.get_node(x);x.children=[];x.children_d=[];var D=A.is("ul")?A.children():A,C=x.id,F=[],B=[],u=this._model.data,t=u[C],E=this._data.core.selected.length,z,y,w;D.each(d.proxy(function(H,G){z=this._parse_model_from_html(d(G),C,t.parents.concat());if(z){F.push(z);B.push(z);if(u[z].children_d.length){B=B.concat(u[z].children_d)}}},this));t.children=F;t.children_d=B;for(y=0,w=t.parents.length;y<w;y++){u[t.parents[y]].children_d=u[t.parents[y]].children_d.concat(B)}this.trigger("model",{nodes:B,parent:C});if(C!==d.jstree.root){this._node_changed(C);this.redraw()}else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(true)}if(this._data.core.selected.length!==E){this.trigger("changed",{action:"model",selected:this._data.core.selected})}v.call(this,true)},_append_json_data:function(v,x,u,y){if(this.element===null){return}v=this.get_node(v);v.children=[];v.children_d=[];if(x.d){x=x.d;if(typeof x==="string"){x=JSON.parse(x)}}if(!d.isArray(x)){x=[x]}var C=null,A={df:this._model.default_state,dat:x,par:v.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},t=function(U,D){if(U.data){U=U.data}var P=U.dat,I=U.par,w=[],E=[],J=[],Q=U.df,G=U.t_id,H=U.t_cnt,L=U.m,K=L[I],M=U.sel,S,O,N,R,T=function(ac,W,V){if(!V){V=[]}else{V=V.concat()}if(W){V.unshift(W)}var X=ac.id.toString(),aa,Y,ad,ab,Z={id:X,text:ac.text||"",icon:ac.icon!==D?ac.icon:true,parent:W,parents:V,children:ac.children||[],children_d:ac.children_d||[],data:ac.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(aa in Q){if(Q.hasOwnProperty(aa)){Z.state[aa]=Q[aa]}}if(ac&&ac.data&&ac.data.jstree&&ac.data.jstree.icon){Z.icon=ac.data.jstree.icon}if(Z.icon===D||Z.icon===null||Z.icon===""){Z.icon=true}if(ac&&ac.data){Z.data=ac.data;if(ac.data.jstree){for(aa in ac.data.jstree){if(ac.data.jstree.hasOwnProperty(aa)){Z.state[aa]=ac.data.jstree[aa]}}}}if(ac&&typeof ac.state==="object"){for(aa in ac.state){if(ac.state.hasOwnProperty(aa)){Z.state[aa]=ac.state[aa]}}}if(ac&&typeof ac.li_attr==="object"){for(aa in ac.li_attr){if(ac.li_attr.hasOwnProperty(aa)){Z.li_attr[aa]=ac.li_attr[aa]}}}if(!Z.li_attr.id){Z.li_attr.id=X}if(ac&&typeof ac.a_attr==="object"){for(aa in ac.a_attr){if(ac.a_attr.hasOwnProperty(aa)){Z.a_attr[aa]=ac.a_attr[aa]}}}if(ac&&ac.children&&ac.children===true){Z.state.loaded=false;Z.children=[];Z.children_d=[]}L[Z.id]=Z;for(aa=0,Y=Z.children.length;aa<Y;aa++){ad=T(L[Z.children[aa]],Z.id,V);ab=L[ad];Z.children_d.push(ad);if(ab.children_d.length){Z.children_d=Z.children_d.concat(ab.children_d)}}delete ac.data;delete ac.children;L[Z.id].original=ac;if(Z.state.selected){J.push(Z.id)}return Z.id},F=function(ac,W,V){if(!V){V=[]}else{V=V.concat()}if(W){V.unshift(W)}var X=false,aa,Y,ad,ab,Z;do{X="j"+G+"_"+(++H)}while(L[X]);Z={id:false,text:typeof ac==="string"?ac:"",icon:typeof ac==="object"&&ac.icon!==D?ac.icon:true,parent:W,parents:V,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(aa in Q){if(Q.hasOwnProperty(aa)){Z.state[aa]=Q[aa]}}if(ac&&ac.id){Z.id=ac.id.toString()}if(ac&&ac.text){Z.text=ac.text}if(ac&&ac.data&&ac.data.jstree&&ac.data.jstree.icon){Z.icon=ac.data.jstree.icon}if(Z.icon===D||Z.icon===null||Z.icon===""){Z.icon=true}if(ac&&ac.data){Z.data=ac.data;if(ac.data.jstree){for(aa in ac.data.jstree){if(ac.data.jstree.hasOwnProperty(aa)){Z.state[aa]=ac.data.jstree[aa]}}}}if(ac&&typeof ac.state==="object"){for(aa in ac.state){if(ac.state.hasOwnProperty(aa)){Z.state[aa]=ac.state[aa]}}}if(ac&&typeof ac.li_attr==="object"){for(aa in ac.li_attr){if(ac.li_attr.hasOwnProperty(aa)){Z.li_attr[aa]=ac.li_attr[aa]}}}if(Z.li_attr.id&&!Z.id){Z.id=Z.li_attr.id.toString()}if(!Z.id){Z.id=X}if(!Z.li_attr.id){Z.li_attr.id=Z.id}if(ac&&typeof ac.a_attr==="object"){for(aa in ac.a_attr){if(ac.a_attr.hasOwnProperty(aa)){Z.a_attr[aa]=ac.a_attr[aa]}}}if(ac&&ac.children&&ac.children.length){for(aa=0,Y=ac.children.length;aa<Y;aa++){ad=F(ac.children[aa],Z.id,V);ab=L[ad];Z.children.push(ad);if(ab.children_d.length){Z.children_d=Z.children_d.concat(ab.children_d)}}Z.children_d=Z.children_d.concat(Z.children)}if(ac&&ac.children&&ac.children===true){Z.state.loaded=false;Z.children=[];Z.children_d=[]}delete ac.data;delete ac.children;Z.original=ac;L[Z.id]=Z;if(Z.state.selected){J.push(Z.id)}return Z.id};if(P.length&&P[0].id!==D&&P[0].parent!==D){for(O=0,N=P.length;O<N;O++){if(!P[O].children){P[O].children=[]}L[P[O].id.toString()]=P[O]}for(O=0,N=P.length;O<N;O++){L[P[O].parent.toString()].children.push(P[O].id.toString());K.children_d.push(P[O].id.toString())}for(O=0,N=K.children.length;O<N;O++){S=T(L[K.children[O]],I,K.parents.concat());E.push(S);if(L[S].children_d.length){E=E.concat(L[S].children_d)}}for(O=0,N=K.parents.length;O<N;O++){L[K.parents[O]].children_d=L[K.parents[O]].children_d.concat(E)}R={cnt:H,mod:L,sel:M,par:I,dpc:E,add:J}}else{for(O=0,N=P.length;O<N;O++){S=F(P[O],I,K.parents.concat());if(S){w.push(S);E.push(S);if(L[S].children_d.length){E=E.concat(L[S].children_d)}}}K.children=w;K.children_d=E;for(O=0,N=K.parents.length;O<N;O++){L[K.parents[O]].children_d=L[K.parents[O]].children_d.concat(E)}R={cnt:H,mod:L,sel:M,par:I,dpc:E,add:J}}if(typeof window==="undefined"||typeof window.document==="undefined"){postMessage(R)}else{return R}},B=function(E,J){if(this.element===null){return}this._cnt=E.cnt;var G,w=this._model.data;for(G in w){if(w.hasOwnProperty(G)&&w[G].state&&w[G].state.loading&&E.mod[G]){E.mod[G].state.loading=true}}this._model.data=E.mod;if(J){var F,D=E.add,I=E.sel,H=this._data.core.selected.slice();w=this._model.data;if(I.length!==H.length||d.vakata.array_unique(I.concat(H)).length!==I.length){for(G=0,F=I.length;G<F;G++){if(d.inArray(I[G],D)===-1&&d.inArray(I[G],H)===-1){w[I[G]].state.selected=false}}for(G=0,F=H.length;G<F;G++){if(d.inArray(H[G],I)===-1){w[H[G]].state.selected=true}}}}if(E.add.length){this._data.core.selected=this._data.core.selected.concat(E.add)}this.trigger("model",{nodes:E.dpc,parent:E.par});if(E.par!==d.jstree.root){this._node_changed(E.par);this.redraw()}else{this.redraw(true)}if(E.add.length){this.trigger("changed",{action:"model",selected:this._data.core.selected})}u.call(this,true)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(this._wrk===null){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+t.toString()],{type:"text/javascript"}))}if(!this._data.core.working||y){this._data.core.working=true;C=new window.Worker(this._wrk);C.onmessage=d.proxy(function(w){B.call(this,w.data,true);try{C.terminate();C=null}catch(D){}if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}},this);if(!A.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}else{C.postMessage(A)}}else{this._data.core.worker_queue.push([v,x,u,true])}}catch(z){B.call(this,t(A),false);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}}else{B.call(this,t(A),false)}},_parse_model_from_html:function(B,u,t){if(!t){t=[]}else{t=[].concat(t)}if(u){t.unshift(u)}var C,A,v=this._model.data,y={id:false,text:false,icon:true,parent:u,parents:t,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false},z,x,w;for(z in this._model.default_state){if(this._model.default_state.hasOwnProperty(z)){y.state[z]=this._model.default_state[z]}}x=d.vakata.attributes(B,true);d.each(x,function(E,D){D=d.trim(D);if(!D.length){return true}y.li_attr[E]=D;if(E==="id"){y.id=D.toString()}});x=B.children("a").first();if(x.length){x=d.vakata.attributes(x,true);d.each(x,function(E,D){D=d.trim(D);if(D.length){y.a_attr[E]=D}})}x=B.children("a").first().length?B.children("a").first().clone():B.clone();x.children("ins, i, ul").remove();x=x.html();x=d("<div />").html(x);y.text=this.settings.core.force_text?x.text():x.html();x=B.data();y.data=x?d.extend(true,{},x):null;y.state.opened=B.hasClass("jstree-open");y.state.selected=B.children("a").hasClass("jstree-clicked");y.state.disabled=B.children("a").hasClass("jstree-disabled");if(y.data&&y.data.jstree){for(z in y.data.jstree){if(y.data.jstree.hasOwnProperty(z)){y.state[z]=y.data.jstree[z]}}}x=B.children("a").children(".jstree-themeicon");if(x.length){y.icon=x.hasClass("jstree-themeicon-hidden")?false:x.attr("rel")}if(y.state.icon!==e){y.icon=y.state.icon}if(y.icon===e||y.icon===null||y.icon===""){y.icon=true}x=B.children("ul").children("li");do{w="j"+this._id+"_"+(++this._cnt)}while(v[w]);y.id=y.li_attr.id?y.li_attr.id.toString():w;if(x.length){x.each(d.proxy(function(E,D){C=this._parse_model_from_html(d(D),y.id,t);A=this._model.data[C];y.children.push(C);if(A.children_d.length){y.children_d=y.children_d.concat(A.children_d)}},this));y.children_d=y.children_d.concat(y.children)}else{if(B.hasClass("jstree-closed")){y.state.loaded=false}}if(y.li_attr["class"]){y.li_attr["class"]=y.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")}if(y.a_attr["class"]){y.a_attr["class"]=y.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")}v[y.id]=y;if(y.state.selected){this._data.core.selected.push(y.id)}return y.id},_parse_model_from_flat_json:function(B,u,t){if(!t){t=[]}else{t=t.concat()}if(u){t.unshift(u)}var w=B.id.toString(),v=this._model.data,D=this._model.default_state,z,x,C,A,y={id:w,text:B.text||"",icon:B.icon!==e?B.icon:true,parent:u,parents:t,children:B.children||[],children_d:B.children_d||[],data:B.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(z in D){if(D.hasOwnProperty(z)){y.state[z]=D[z]}}if(B&&B.data&&B.data.jstree&&B.data.jstree.icon){y.icon=B.data.jstree.icon}if(y.icon===e||y.icon===null||y.icon===""){y.icon=true}if(B&&B.data){y.data=B.data;if(B.data.jstree){for(z in B.data.jstree){if(B.data.jstree.hasOwnProperty(z)){y.state[z]=B.data.jstree[z]}}}}if(B&&typeof B.state==="object"){for(z in B.state){if(B.state.hasOwnProperty(z)){y.state[z]=B.state[z]}}}if(B&&typeof B.li_attr==="object"){for(z in B.li_attr){if(B.li_attr.hasOwnProperty(z)){y.li_attr[z]=B.li_attr[z]}}}if(!y.li_attr.id){y.li_attr.id=w}if(B&&typeof B.a_attr==="object"){for(z in B.a_attr){if(B.a_attr.hasOwnProperty(z)){y.a_attr[z]=B.a_attr[z]}}}if(B&&B.children&&B.children===true){y.state.loaded=false;y.children=[];y.children_d=[]}v[y.id]=y;for(z=0,x=y.children.length;z<x;z++){C=this._parse_model_from_flat_json(v[y.children[z]],y.id,t);A=v[C];y.children_d.push(C);if(A.children_d.length){y.children_d=y.children_d.concat(A.children_d)}}delete B.data;delete B.children;v[y.id].original=B;if(y.state.selected){this._data.core.selected.push(y.id)}return y.id},_parse_model_from_json:function(B,u,t){if(!t){t=[]}else{t=t.concat()}if(u){t.unshift(u)}var w=false,z,x,C,A,v=this._model.data,D=this._model.default_state,y;do{w="j"+this._id+"_"+(++this._cnt)}while(v[w]);y={id:false,text:typeof B==="string"?B:"",icon:typeof B==="object"&&B.icon!==e?B.icon:true,parent:u,parents:t,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(z in D){if(D.hasOwnProperty(z)){y.state[z]=D[z]}}if(B&&B.id){y.id=B.id.toString()}if(B&&B.text){y.text=B.text}if(B&&B.data&&B.data.jstree&&B.data.jstree.icon){y.icon=B.data.jstree.icon}if(y.icon===e||y.icon===null||y.icon===""){y.icon=true}if(B&&B.data){y.data=B.data;if(B.data.jstree){for(z in B.data.jstree){if(B.data.jstree.hasOwnProperty(z)){y.state[z]=B.data.jstree[z]}}}}if(B&&typeof B.state==="object"){for(z in B.state){if(B.state.hasOwnProperty(z)){y.state[z]=B.state[z]}}}if(B&&typeof B.li_attr==="object"){for(z in B.li_attr){if(B.li_attr.hasOwnProperty(z)){y.li_attr[z]=B.li_attr[z]}}}if(y.li_attr.id&&!y.id){y.id=y.li_attr.id.toString()}if(!y.id){y.id=w}if(!y.li_attr.id){y.li_attr.id=y.id}if(B&&typeof B.a_attr==="object"){for(z in B.a_attr){if(B.a_attr.hasOwnProperty(z)){y.a_attr[z]=B.a_attr[z]}}}if(B&&B.children&&B.children.length){for(z=0,x=B.children.length;z<x;z++){C=this._parse_model_from_json(B.children[z],y.id,t);A=v[C];y.children.push(C);if(A.children_d.length){y.children_d=y.children_d.concat(A.children_d)}}y.children_d=y.children_d.concat(y.children)}if(B&&B.children&&B.children===true){y.state.loaded=false;y.children=[];y.children_d=[]}delete B.data;delete B.children;y.original=B;v[y.id]=y;if(y.state.selected){this._data.core.selected.push(y.id)}return y.id},_redraw:function(){var t=this._model.force_full_redraw?this._model.data[d.jstree.root].children.concat([]):this._model.changed.concat([]),y=o.createElement("UL"),x,w,v,u=this._data.core.focused;for(w=0,v=t.length;w<v;w++){x=this.redraw_node(t[w],true,this._model.force_full_redraw);if(x&&this._model.force_full_redraw){y.appendChild(x)}}if(this._model.force_full_redraw){y.className=this.get_container_ul()[0].className;y.setAttribute("role","group");this.element.empty().append(y)}if(u!==null){x=this.get_node(u,true);if(x&&x.length&&x.children(".jstree-anchor")[0]!==o.activeElement){x.children(".jstree-anchor").focus()}else{this._data.core.focused=null}}this._model.force_full_redraw=false;this._model.changed=[];this.trigger("redraw",{nodes:t})},redraw:function(t){if(t){this._model.force_full_redraw=true}this._redraw()},draw_children:function(w){var x=this.get_node(w),v=false,u=false,t=false,y=o;if(!x){return false}if(x.id===d.jstree.root){return this.redraw(true)}w=this.get_node(w,true);if(!w||!w.length){return false}w.children(".jstree-children").remove();w=w[0];if(x.children.length&&x.state.loaded){t=y.createElement("UL");t.setAttribute("role","group");t.className="jstree-children";for(v=0,u=x.children.length;v<u;v++){t.appendChild(this.redraw_node(x.children[v],true,true))}w.appendChild(t)}},redraw_node:function(D,I,v,L){var y=this.get_node(D),C=false,x=false,u=false,J=false,H=false,G=false,N="",M=o,E=this._model.data,K=false,B=false,O=null,z=0,F=0,A=false,w=false;if(!y){return false}if(y.id===d.jstree.root){return this.redraw(true)}I=I||y.children.length===0;D=!o.querySelector?o.getElementById(y.id):this.element[0].querySelector("#"+("0123456789".indexOf(y.id[0])!==-1?"\\3"+y.id[0]+" "+y.id.substr(1).replace(d.jstree.idregex,"\\$&"):y.id.replace(d.jstree.idregex,"\\$&")));if(!D){I=true;if(!v){C=y.parent!==d.jstree.root?d("#"+y.parent.replace(d.jstree.idregex,"\\$&"),this.element)[0]:null;if(C!==null&&(!C||!E[y.parent].state.opened)){return false}x=d.inArray(y.id,C===null?E[d.jstree.root].children:E[y.parent].children)}}else{D=d(D);if(!v){C=D.parent().parent()[0];if(C===this.element[0]){C=null}x=D.index()}if(!I&&y.children.length&&!D.children(".jstree-children").length){I=true}if(!I){u=D.children(".jstree-children")[0]}K=D.children(".jstree-anchor")[0]===o.activeElement;D.remove()}D=f.cloneNode(true);N="jstree-node ";for(J in y.li_attr){if(y.li_attr.hasOwnProperty(J)){if(J==="id"){continue}if(J!=="class"){D.setAttribute(J,y.li_attr[J])}else{N+=y.li_attr[J]}}}if(!y.a_attr.id){y.a_attr.id=y.id+"_anchor"}D.setAttribute("aria-selected",!!y.state.selected);D.setAttribute("aria-level",y.parents.length);D.setAttribute("aria-labelledby",y.a_attr.id);if(y.state.disabled){D.setAttribute("aria-disabled",true)}for(J=0,H=y.children.length;J<H;J++){if(!E[y.children[J]].state.hidden){A=true;break}}if(y.parent!==null&&E[y.parent]&&!y.state.hidden){J=d.inArray(y.id,E[y.parent].children);w=y.id;if(J!==-1){J++;for(H=E[y.parent].children.length;J<H;J++){if(!E[E[y.parent].children[J]].state.hidden){w=E[y.parent].children[J]}if(w!==y.id){break}}}}if(y.state.hidden){N+=" jstree-hidden"}if(y.state.loaded&&!A){N+=" jstree-leaf"}else{N+=y.state.opened&&y.state.loaded?" jstree-open":" jstree-closed";D.setAttribute("aria-expanded",(y.state.opened&&y.state.loaded))}if(w===y.id){N+=" jstree-last"}D.id=y.id;D.className=N;N=(y.state.selected?" jstree-clicked":"")+(y.state.disabled?" jstree-disabled":"");for(H in y.a_attr){if(y.a_attr.hasOwnProperty(H)){if(H==="href"&&y.a_attr[H]==="#"){continue}if(H!=="class"){D.childNodes[1].setAttribute(H,y.a_attr[H])}else{N+=" "+y.a_attr[H]}}}if(N.length){D.childNodes[1].className="jstree-anchor "+N}if((y.icon&&y.icon!==true)||y.icon===false){if(y.icon===false){D.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}else{if(y.icon.indexOf("/")===-1&&y.icon.indexOf(".")===-1){D.childNodes[1].childNodes[0].className+=" "+y.icon+" jstree-themeicon-custom"}else{D.childNodes[1].childNodes[0].style.backgroundImage='url("'+y.icon+'")';D.childNodes[1].childNodes[0].style.backgroundPosition="center center";D.childNodes[1].childNodes[0].style.backgroundSize="auto";D.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}}}if(this.settings.core.force_text){D.childNodes[1].appendChild(M.createTextNode(y.text))}else{D.childNodes[1].innerHTML+=y.text}if(I&&y.children.length&&(y.state.opened||L)&&y.state.loaded){G=M.createElement("UL");G.setAttribute("role","group");G.className="jstree-children";for(J=0,H=y.children.length;J<H;J++){G.appendChild(this.redraw_node(y.children[J],I,true))}D.appendChild(G)}if(u){D.appendChild(u)}if(!v){if(!C){C=this.element[0]}for(J=0,H=C.childNodes.length;J<H;J++){if(C.childNodes[J]&&C.childNodes[J].className&&C.childNodes[J].className.indexOf("jstree-children")!==-1){O=C.childNodes[J];break}}if(!O){O=M.createElement("UL");O.setAttribute("role","group");O.className="jstree-children";C.appendChild(O)}C=O;if(x<C.childNodes.length){C.insertBefore(D,C.childNodes[x])}else{C.appendChild(D)}if(K){z=this.element[0].scrollTop;F=this.element[0].scrollLeft;D.childNodes[1].focus();this.element[0].scrollTop=z;this.element[0].scrollLeft=F}}if(y.state.opened&&!y.state.loaded){y.state.opened=false;setTimeout(d.proxy(function(){this.open_node(y.id,false,0)},this),0)}return D},open_node:function(y,A,x){var w,v,z,u;if(d.isArray(y)){y=y.slice();for(w=0,v=y.length;w<v;w++){this.open_node(y[w],A,x)}return true}y=this.get_node(y);if(!y||y.id===d.jstree.root){return false}x=x===e?this.settings.core.animation:x;if(!this.is_closed(y)){if(A){A.call(this,y,false)}return false}if(!this.is_loaded(y)){if(this.is_loading(y)){return setTimeout(d.proxy(function(){this.open_node(y,A,x)},this),500)}this.load_node(y,function(B,t){return t?this.open_node(B,A,x):(A?A.call(this,B,false):false)})}else{z=this.get_node(y,true);u=this;if(z.length){if(x&&z.children(".jstree-children").length){z.children(".jstree-children").stop(true,true)}if(y.children.length&&!this._firstChild(z.children(".jstree-children")[0])){this.draw_children(y)}if(!x){this.trigger("before_open",{node:y});z[0].className=z[0].className.replace("jstree-closed","jstree-open");z[0].setAttribute("aria-expanded",true)}else{this.trigger("before_open",{node:y});z.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",true).children(".jstree-children").stop(true,true).slideDown(x,function(){this.style.display="";if(u.element){u.trigger("after_open",{node:y})}})}}y.state.opened=true;if(A){A.call(this,y,true)}if(!z.length){this.trigger("before_open",{node:y})}this.trigger("open_node",{node:y});if(!x||!z.length){this.trigger("after_open",{node:y})}return true}},_open_to:function(w){w=this.get_node(w);if(!w||w.id===d.jstree.root){return false}var u,t,v=w.parents;for(u=0,t=v.length;u<t;u+=1){if(u!==d.jstree.root){this.open_node(v[u],false,0)}}return d("#"+w.id.replace(d.jstree.idregex,"\\$&"),this.element)},close_node:function(y,x){var w,v,u,z;if(d.isArray(y)){y=y.slice();for(w=0,v=y.length;w<v;w++){this.close_node(y[w],x)}return true}y=this.get_node(y);if(!y||y.id===d.jstree.root){return false}if(this.is_closed(y)){return false}x=x===e?this.settings.core.animation:x;u=this;z=this.get_node(y,true);y.state.opened=false;this.trigger("close_node",{node:y});if(!z.length){this.trigger("after_close",{node:y})}else{if(!x){z[0].className=z[0].className.replace("jstree-open","jstree-closed");z.attr("aria-expanded",false).children(".jstree-children").remove();this.trigger("after_close",{node:y})}else{z.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",false).children(".jstree-children").stop(true,true).slideUp(x,function(){this.style.display="";z.children(".jstree-children").remove();if(u.element){u.trigger("after_close",{node:y})}})}}},toggle_node:function(v){var u,t;if(d.isArray(v)){v=v.slice();for(u=0,t=v.length;u<t;u++){this.toggle_node(v[u])}return true}if(this.is_closed(v)){return this.open_node(v)}if(this.is_open(v)){return this.close_node(v)}},open_all:function(x,w,t){if(!x){x=d.jstree.root}x=this.get_node(x);if(!x){return false}var y=x.id===d.jstree.root?this.get_container_ul():this.get_node(x,true),v,u,z;if(!y.length){for(v=0,u=x.children_d.length;v<u;v++){if(this.is_closed(this._model.data[x.children_d[v]])){this._model.data[x.children_d[v]].state.opened=true}}return this.trigger("open_all",{node:x})}t=t||y;z=this;y=this.is_closed(x)?y.find(".jstree-closed").addBack():y.find(".jstree-closed");y.each(function(){z.open_node(this,function(B,A){if(A&&this.is_parent(B)){this.open_all(B,w,t)}},w||0)});if(t.find(".jstree-closed").length===0){this.trigger("open_all",{node:this.get_node(t)})}},close_all:function(w,v){if(!w){w=d.jstree.root}w=this.get_node(w);if(!w){return false}var x=w.id===d.jstree.root?this.get_container_ul():this.get_node(w,true),y=this,u,t;if(x.length){x=this.is_open(w)?x.find(".jstree-open").addBack():x.find(".jstree-open");d(x.get().reverse()).each(function(){y.close_node(this,v||0)})}for(u=0,t=w.children_d.length;u<t;u++){this._model.data[w.children_d[u]].state.opened=false}this.trigger("close_all",{node:w})},is_disabled:function(t){t=this.get_node(t);return t&&t.state&&t.state.disabled},enable_node:function(v){var u,t;if(d.isArray(v)){v=v.slice();for(u=0,t=v.length;u<t;u++){this.enable_node(v[u])}return true}v=this.get_node(v);if(!v||v.id===d.jstree.root){return false}v.state.disabled=false;this.get_node(v,true).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",false);this.trigger("enable_node",{node:v})},disable_node:function(v){var u,t;if(d.isArray(v)){v=v.slice();for(u=0,t=v.length;u<t;u++){this.disable_node(v[u])}return true}v=this.get_node(v);if(!v||v.id===d.jstree.root){return false}v.state.disabled=true;this.get_node(v,true).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",true);this.trigger("disable_node",{node:v})},is_hidden:function(t){t=this.get_node(t);return t.state.hidden===true},hide_node:function(w,v){var u,t;if(d.isArray(w)){w=w.slice();for(u=0,t=w.length;u<t;u++){this.hide_node(w[u],true)}if(!v){this.redraw()}return true}w=this.get_node(w);if(!w||w.id===d.jstree.root){return false}if(!w.state.hidden){w.state.hidden=true;this._node_changed(w.parent);if(!v){this.redraw()}this.trigger("hide_node",{node:w})}},show_node:function(w,v){var u,t;if(d.isArray(w)){w=w.slice();for(u=0,t=w.length;u<t;u++){this.show_node(w[u],true)}if(!v){this.redraw()}return true}w=this.get_node(w);if(!w||w.id===d.jstree.root){return false}if(w.state.hidden){w.state.hidden=false;this._node_changed(w.parent);if(!v){this.redraw()}this.trigger("show_node",{node:w})}},hide_all:function(w){var u,t=this._model.data,v=[];for(u in t){if(t.hasOwnProperty(u)&&u!==d.jstree.root&&!t[u].state.hidden){t[u].state.hidden=true;v.push(u)}}this._model.force_full_redraw=true;if(!w){this.redraw()}this.trigger("hide_all",{nodes:v});return v},show_all:function(w){var u,t=this._model.data,v=[];for(u in t){if(t.hasOwnProperty(u)&&u!==d.jstree.root&&t[u].state.hidden){t[u].state.hidden=false;v.push(u)}}this._model.force_full_redraw=true;if(!w){this.redraw()}this.trigger("show_all",{nodes:v});return v},activate_node:function(y,x){if(this.is_disabled(y)){return false}if(!x||typeof x!=="object"){x={}}this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==e?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null}if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])}if(!this.settings.core.multiple||(!x.metaKey&&!x.ctrlKey&&!x.shiftKey)||(x.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(y)||this.get_parent(y)!==this._data.core.last_clicked.parent))){if(!this.settings.core.multiple&&(x.metaKey||x.ctrlKey||x.shiftKey)&&this.is_selected(y)){this.deselect_node(y,false,x)}else{this.deselect_all(true);this.select_node(y,false,false,x);this._data.core.last_clicked=this.get_node(y)}}else{if(x.shiftKey){var z=this.get_node(y).id,t=this._data.core.last_clicked.id,w=this.get_node(this._data.core.last_clicked.parent).children,A=false,v,u;for(v=0,u=w.length;v<u;v+=1){if(w[v]===z){A=!A}if(w[v]===t){A=!A}if(!this.is_disabled(w[v])&&(A||w[v]===z||w[v]===t)){if(!this.is_hidden(w[v])){this.select_node(w[v],true,false,x)}}else{this.deselect_node(w[v],true,x)}}this.trigger("changed",{action:"select_node",node:this.get_node(y),selected:this._data.core.selected,event:x})}else{if(!this.is_selected(y)){this.select_node(y,false,false,x)}else{this.deselect_node(y,false,x)}}}this.trigger("activate_node",{node:this.get_node(y),event:x})},hover_node:function(v){v=this.get_node(v,true);if(!v||!v.length||v.children(".jstree-hovered").length){return false}var w=this.element.find(".jstree-hovered"),u=this.element;if(w&&w.length){this.dehover_node(w)}v.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(v)});setTimeout(function(){u.attr("aria-activedescendant",v[0].id)},0)},dehover_node:function(t){t=this.get_node(t,true);if(!t||!t.length||!t.children(".jstree-hovered").length){return false}t.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(t)})},select_node:function(y,A,t,x){var z,w,u,v;if(d.isArray(y)){y=y.slice();for(w=0,u=y.length;w<u;w++){this.select_node(y[w],A,t,x)}return true}y=this.get_node(y);if(!y||y.id===d.jstree.root){return false}z=this.get_node(y,true);if(!y.state.selected){y.state.selected=true;this._data.core.selected.push(y.id);if(!t){z=this._open_to(y)}if(z&&z.length){z.attr("aria-selected",true).children(".jstree-anchor").addClass("jstree-clicked")}this.trigger("select_node",{node:y,selected:this._data.core.selected,event:x});if(!A){this.trigger("changed",{action:"select_node",node:y,selected:this._data.core.selected,event:x})}}},deselect_node:function(w,y,v){var u,t,x;if(d.isArray(w)){w=w.slice();for(u=0,t=w.length;u<t;u++){this.deselect_node(w[u],y,v)}return true}w=this.get_node(w);if(!w||w.id===d.jstree.root){return false}x=this.get_node(w,true);if(w.state.selected){w.state.selected=false;this._data.core.selected=d.vakata.array_remove_item(this._data.core.selected,w.id);if(x.length){x.attr("aria-selected",false).children(".jstree-anchor").removeClass("jstree-clicked")}this.trigger("deselect_node",{node:w,selected:this._data.core.selected,event:v});if(!y){this.trigger("changed",{action:"deselect_node",node:w,selected:this._data.core.selected,event:v})}}},select_all:function(w){var v=this._data.core.selected.concat([]),u,t;this._data.core.selected=this._model.data[d.jstree.root].children_d.concat();for(u=0,t=this._data.core.selected.length;u<t;u++){if(this._model.data[this._data.core.selected[u]]){this._model.data[this._data.core.selected[u]].state.selected=true}}this.redraw(true);this.trigger("select_all",{selected:this._data.core.selected});if(!w){this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:v})}},deselect_all:function(w){var v=this._data.core.selected.concat([]),u,t;for(u=0,t=this._data.core.selected.length;u<t;u++){if(this._model.data[this._data.core.selected[u]]){this._model.data[this._data.core.selected[u]].state.selected=false}}this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",false);this.trigger("deselect_all",{selected:this._data.core.selected,node:v});if(!w){this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:v})}},is_selected:function(t){t=this.get_node(t);if(!t||t.id===d.jstree.root){return false}return t.state.selected},get_selected:function(t){return t?d.map(this._data.core.selected,d.proxy(function(u){return this.get_node(u)},this)):this._data.core.selected.slice()},get_top_selected:function(y){var x=this.get_selected(true),z={},w,v,u,t;for(w=0,v=x.length;w<v;w++){z[x[w].id]=x[w]}for(w=0,v=x.length;w<v;w++){for(u=0,t=x[w].children_d.length;u<t;u++){if(z[x[w].children_d[u]]){delete z[x[w].children_d[u]]}}}x=[];for(w in z){if(z.hasOwnProperty(w)){x.push(w)}}return y?d.map(x,d.proxy(function(A){return this.get_node(A)},this)):x},get_bottom_selected:function(w){var v=this.get_selected(true),x=[],u,t;for(u=0,t=v.length;u<t;u++){if(!v[u].children.length){x.push(v[u].id)}}return w?d.map(x,d.proxy(function(y){return this.get_node(y)},this)):x},get_state:function(){var u={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},
/*!
					'themes' : {
						'name' : this.get_theme(),
						'icons' : this._data.core.themes.icons,
						'dots' : this._data.core.themes.dots
					},
					*/
selected:[]}},t;for(t in this._model.data){if(this._model.data.hasOwnProperty(t)){if(t!==d.jstree.root){if(this._model.data[t].state.opened){u.core.open.push(t)}if(this._model.data[t].state.selected){u.core.selected.push(t)}}}}return u},set_state:function(x,A){if(x){if(x.core){var w,z,v,y,u;if(x.core.open){if(!d.isArray(x.core.open)||!x.core.open.length){delete x.core.open;this.set_state(x,A)}else{this._load_nodes(x.core.open,function(t){this.open_node(t,false,0);delete x.core.open;this.set_state(x,A)},true)}return false}if(x.core.scroll){if(x.core.scroll&&x.core.scroll.left!==e){this.element.scrollLeft(x.core.scroll.left)}if(x.core.scroll&&x.core.scroll.top!==e){this.element.scrollTop(x.core.scroll.top)}delete x.core.scroll;this.set_state(x,A);return false}if(x.core.selected){y=this;this.deselect_all();d.each(x.core.selected,function(B,t){y.select_node(t,false,true)});delete x.core.selected;this.set_state(x,A);return false}for(u in x){if(x.hasOwnProperty(u)&&u!=="core"&&d.inArray(u,this.settings.plugins)===-1){delete x[u]}}if(d.isEmptyObject(x.core)){delete x.core;this.set_state(x,A);return false}}if(d.isEmptyObject(x)){x=null;if(A){A.call(this)}this.trigger("set_state");return false}return true}return false},refresh:function(u,t){this._data.core.state=t===true?{}:this.get_state();if(t&&d.isFunction(t)){this._data.core.state=t.call(this,this._data.core.state)}this._cnt=0;this._model.data={};this._model.data[d.jstree.root]={id:d.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:false}};this._data.core.selected=[];this._data.core.last_clicked=null;this._data.core.focused=null;var v=this.get_container_ul()[0].className;if(!u){this.element.html("<ul class='"+v+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading")}this.load_node(d.jstree.root,function(x,w){if(w){this.get_container_ul()[0].className=v;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.set_state(d.extend(true,{},this._data.core.state),function(){this.trigger("refresh")})}this._data.core.state=null})},refresh_node:function(v){v=this.get_node(v);if(!v||v.id===d.jstree.root){return false}var w=[],t=[],u=this._data.core.selected.concat([]);t.push(v.id);if(v.state.opened===true){w.push(v.id)}this.get_node(v,true).find(".jstree-open").each(function(){t.push(this.id);w.push(this.id)});this._load_nodes(t,d.proxy(function(x){this.open_node(w,false,0);this.select_node(u);this.trigger("refresh_node",{node:v,nodes:x})},this),false,true)},set_id:function(x,y){x=this.get_node(x);if(!x||x.id===d.jstree.root){return false}var w,v,t=this._model.data,u=x.id;y=y.toString();t[x.parent].children[d.inArray(x.id,t[x.parent].children)]=y;for(w=0,v=x.parents.length;w<v;w++){t[x.parents[w]].children_d[d.inArray(x.id,t[x.parents[w]].children_d)]=y}for(w=0,v=x.children.length;w<v;w++){t[x.children[w]].parent=y}for(w=0,v=x.children_d.length;w<v;w++){t[x.children_d[w]].parents[d.inArray(x.id,t[x.children_d[w]].parents)]=y}w=d.inArray(x.id,this._data.core.selected);if(w!==-1){this._data.core.selected[w]=y}w=this.get_node(x.id,true);if(w){w.attr("id",y);if(this.element.attr("aria-activedescendant")===x.id){this.element.attr("aria-activedescendant",y)}}delete t[x.id];x.id=y;x.li_attr.id=y;t[y]=x;this.trigger("set_id",{node:x,"new":x.id,old:u});return true},get_text:function(t){t=this.get_node(t);return(!t||t.id===d.jstree.root)?false:t.text},set_text:function(v,w){var u,t;if(d.isArray(v)){v=v.slice();for(u=0,t=v.length;u<t;u++){this.set_text(v[u],w)}return true}v=this.get_node(v);if(!v||v.id===d.jstree.root){return false}v.text=w;if(this.get_node(v,true).length){this.redraw_node(v.id)}this.trigger("set_text",{obj:v,text:w});return true},get_json:function(x,u,y){x=this.get_node(x||d.jstree.root);if(!x){return false}if(u&&u.flat&&!y){y=[]}var w={id:x.id,text:x.text,icon:this.get_icon(x),li_attr:d.extend(true,{},x.li_attr),a_attr:d.extend(true,{},x.a_attr),state:{},data:u&&u.no_data?false:d.extend(true,{},x.data)},v,t;if(u&&u.flat){w.parent=x.parent}else{w.children=[]}if(!u||!u.no_state){for(v in x.state){if(x.state.hasOwnProperty(v)){w.state[v]=x.state[v]}}}if(u&&u.no_id){delete w.id;if(w.li_attr&&w.li_attr.id){delete w.li_attr.id}if(w.a_attr&&w.a_attr.id){delete w.a_attr.id}}if(u&&u.flat&&x.id!==d.jstree.root){y.push(w)}if(!u||!u.no_children){for(v=0,t=x.children.length;v<t;v++){if(u&&u.flat){this.get_json(x.children[v],u,y)}else{w.children.push(this.get_json(x.children[v],u))}}}return u&&u.flat?y:(x.id===d.jstree.root?w.children:w)},create_node:function(y,t,A,B,z){if(y===null){y=d.jstree.root}y=this.get_node(y);if(!y){return false}A=A===e?"last":A;if(!A.toString().match(/^(before|after)$/)&&!z&&!this.is_loaded(y)){return this.load_node(y,function(){this.create_node(y,t,A,B,true)})}if(!t){t={text:this.get_string("New node")}}if(typeof t==="string"){t={text:t}}if(t.text===e){t.text=this.get_string("New node")}var v,x,w,u;if(y.id===d.jstree.root){if(A==="before"){A="first"}if(A==="after"){A="last"}}switch(A){case"before":v=this.get_node(y.parent);A=d.inArray(y.id,v.children);y=v;break;case"after":v=this.get_node(y.parent);A=d.inArray(y.id,v.children)+1;y=v;break;case"inside":case"first":A=0;break;case"last":A=y.children.length;break;default:if(!A){A=0}break}if(A>y.children.length){A=y.children.length}if(!t.id){t.id=true}if(!this.check("create_node",t,y,A)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(t.id===true){delete t.id}t=this._parse_model_from_json(t,y.id,y.parents.concat());if(!t){return false}v=this.get_node(t);x=[];x.push(t);x=x.concat(v.children_d);this.trigger("model",{nodes:x,parent:y.id});y.children_d=y.children_d.concat(x);for(w=0,u=y.parents.length;w<u;w++){this._model.data[y.parents[w]].children_d=this._model.data[y.parents[w]].children_d.concat(x)}t=v;v=[];for(w=0,u=y.children.length;w<u;w++){v[w>=A?w+1:w]=y.children[w]}v[A]=t.id;y.children=v;this.redraw_node(y,true);if(B){B.call(this,this.get_node(t))}this.trigger("create_node",{node:this.get_node(t),parent:y.id,position:A});return t.id},rename_node:function(w,x){var v,u,t;if(d.isArray(w)){w=w.slice();for(v=0,u=w.length;v<u;v++){this.rename_node(w[v],x)}return true}w=this.get_node(w);if(!w||w.id===d.jstree.root){return false}t=w.text;if(!this.check("rename_node",w,this.get_parent(w),x)){this.settings.core.error.call(this,this._data.core.last_error);return false}this.set_text(w,x);this.trigger("rename_node",{node:w,text:x,old:t});return true},delete_node:function(w){var A,z,B,E,x,y,v,u,t,C,D,F;if(d.isArray(w)){w=w.slice();for(A=0,z=w.length;A<z;A++){this.delete_node(w[A])}return true}w=this.get_node(w);if(!w||w.id===d.jstree.root){return false}B=this.get_node(w.parent);E=d.inArray(w.id,B.children);C=false;if(!this.check("delete_node",w,B,E)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(E!==-1){B.children=d.vakata.array_remove(B.children,E)}x=w.children_d.concat([]);x.push(w.id);for(y=0,v=w.parents.length;y<v;y++){this._model.data[w.parents[y]].children_d=d.vakata.array_filter(this._model.data[w.parents[y]].children_d,function(G){return d.inArray(G,x)===-1})}for(u=0,t=x.length;u<t;u++){if(this._model.data[x[u]].state.selected){C=true;break}}if(C){this._data.core.selected=d.vakata.array_filter(this._data.core.selected,function(G){return d.inArray(G,x)===-1})}this.trigger("delete_node",{node:w,parent:B.id});if(C){this.trigger("changed",{action:"delete_node",node:w,selected:this._data.core.selected,parent:B.id})}for(u=0,t=x.length;u<t;u++){delete this._model.data[x[u]]}if(d.inArray(this._data.core.focused,x)!==-1){this._data.core.focused=null;D=this.element[0].scrollTop;F=this.element[0].scrollLeft;if(B.id===d.jstree.root){if(this._model.data[d.jstree.root].children[0]){this.get_node(this._model.data[d.jstree.root].children[0],true).children(".jstree-anchor").focus()}}else{this.get_node(B,true).children(".jstree-anchor").focus()}this.element[0].scrollTop=D;this.element[0].scrollLeft=F}this.redraw_node(B,true);return true},check:function(t,x,w,z,v){x=x&&x.id?x:this.get_node(x);w=w&&w.id?w:this.get_node(w);var u=t.match(/^move_node|copy_node|create_node$/i)?w:x,y=this.settings.core.check_callback;if(t==="move_node"||t==="copy_node"){if((!v||!v.is_multi)&&(x.id===w.id||(t==="move_node"&&d.inArray(x.id,w.children)===z)||d.inArray(w.id,x.children_d)!==-1)){this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:z,obj:x&&x.id?x.id:false,par:w&&w.id?w.id:false})};return false}}if(u&&u.data){u=u.data}if(u&&u.functions&&(u.functions[t]===false||u.functions[t]===true)){if(u.functions[t]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:z,obj:x&&x.id?x.id:false,par:w&&w.id?w.id:false})}}return u.functions[t]}if(y===false||(d.isFunction(y)&&y.call(this,t,x,w,z,v)===false)||(y&&y[t]===false)){this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:z,obj:x&&x.id?x.id:false,par:w&&w.id?w.id:false})};return false}return true},last_error:function(){return this._data.core.last_error},move_node:function(B,D,w,u,C,J,M){var z,y,A,t,L,N,v,x,K,I,H,G,F,E;D=this.get_node(D);w=w===e?0:w;if(!D){return false}if(!w.toString().match(/^(before|after)$/)&&!C&&!this.is_loaded(D)){return this.load_node(D,function(){this.move_node(B,D,w,u,true,false,M)})}if(d.isArray(B)){if(B.length===1){B=B[0]}else{for(z=0,y=B.length;z<y;z++){if((K=this.move_node(B[z],D,w,u,C,false,M))){D=K;w="after"}}this.redraw();return true}}B=B&&B.id?B:this.get_node(B);if(!B||B.id===d.jstree.root){return false}A=(B.parent||d.jstree.root).toString();L=(!w.toString().match(/^(before|after)$/)||D.id===d.jstree.root)?D:this.get_node(D.parent);N=M?M:(this._model.data[B.id]?this:d.jstree.reference(B.id));v=!N||!N._id||(this._id!==N._id);t=N&&N._id&&A&&N._model.data[A]&&N._model.data[A].children?d.inArray(B.id,N._model.data[A].children):-1;if(N&&N._id){B=N._model.data[B.id]}if(v){if((K=this.copy_node(B,D,w,u,C,false,M))){if(N){N.delete_node(B)}return K}return false}if(D.id===d.jstree.root){if(w==="before"){w="first"}if(w==="after"){w="last"}}switch(w){case"before":w=d.inArray(D.id,L.children);break;case"after":w=d.inArray(D.id,L.children)+1;break;case"inside":case"first":w=0;break;case"last":w=L.children.length;break;default:if(!w){w=0}break}if(w>L.children.length){w=L.children.length}if(!this.check("move_node",B,L,w,{core:true,origin:M,is_multi:(N&&N._id&&N._id!==this._id),is_foreign:(!N||!N._id)})){this.settings.core.error.call(this,this._data.core.last_error);return false}if(B.parent===L.id){x=L.children.concat();K=d.inArray(B.id,x);if(K!==-1){x=d.vakata.array_remove(x,K);if(w>K){w--}}K=[];for(I=0,H=x.length;I<H;I++){K[I>=w?I+1:I]=x[I]}K[w]=B.id;L.children=K;this._node_changed(L.id);this.redraw(L.id===d.jstree.root)}else{K=B.children_d.concat();K.push(B.id);for(I=0,H=B.parents.length;I<H;I++){x=[];E=N._model.data[B.parents[I]].children_d;for(G=0,F=E.length;G<F;G++){if(d.inArray(E[G],K)===-1){x.push(E[G])}}N._model.data[B.parents[I]].children_d=x}N._model.data[A].children=d.vakata.array_remove_item(N._model.data[A].children,B.id);for(I=0,H=L.parents.length;I<H;I++){this._model.data[L.parents[I]].children_d=this._model.data[L.parents[I]].children_d.concat(K)}x=[];for(I=0,H=L.children.length;I<H;I++){x[I>=w?I+1:I]=L.children[I]}x[w]=B.id;L.children=x;L.children_d.push(B.id);L.children_d=L.children_d.concat(B.children_d);B.parent=L.id;K=L.parents.concat();K.unshift(L.id);E=B.parents.length;B.parents=K;K=K.concat();for(I=0,H=B.children_d.length;I<H;I++){this._model.data[B.children_d[I]].parents=this._model.data[B.children_d[I]].parents.slice(0,E*-1);Array.prototype.push.apply(this._model.data[B.children_d[I]].parents,K)}if(A===d.jstree.root||L.id===d.jstree.root){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(A);this._node_changed(L.id)}if(!J){this.redraw()}}if(u){u.call(this,B,L,w)}this.trigger("move_node",{node:B,parent:L.id,position:w,old_parent:A,old_position:t,is_multi:(N&&N._id&&N._id!==this._id),is_foreign:(!N||!N._id),old_instance:N,new_instance:this});return B.id},copy_node:function(A,C,v,u,B,G,J){var y,x,w,H,F,E,D,z,I,K,t;C=this.get_node(C);v=v===e?0:v;if(!C){return false}if(!v.toString().match(/^(before|after)$/)&&!B&&!this.is_loaded(C)){return this.load_node(C,function(){this.copy_node(A,C,v,u,true,false,J)})}if(d.isArray(A)){if(A.length===1){A=A[0]}else{for(y=0,x=A.length;y<x;y++){if((H=this.copy_node(A[y],C,v,u,B,true,J))){C=H;v="after"}}this.redraw();return true}}A=A&&A.id?A:this.get_node(A);if(!A||A.id===d.jstree.root){return false}z=(A.parent||d.jstree.root).toString();I=(!v.toString().match(/^(before|after)$/)||C.id===d.jstree.root)?C:this.get_node(C.parent);K=J?J:(this._model.data[A.id]?this:d.jstree.reference(A.id));t=!K||!K._id||(this._id!==K._id);if(K&&K._id){A=K._model.data[A.id]}if(C.id===d.jstree.root){if(v==="before"){v="first"}if(v==="after"){v="last"}}switch(v){case"before":v=d.inArray(C.id,I.children);break;case"after":v=d.inArray(C.id,I.children)+1;break;case"inside":case"first":v=0;break;case"last":v=I.children.length;break;default:if(!v){v=0}break}if(v>I.children.length){v=I.children.length}if(!this.check("copy_node",A,I,v,{core:true,origin:J,is_multi:(K&&K._id&&K._id!==this._id),is_foreign:(!K||!K._id)})){this.settings.core.error.call(this,this._data.core.last_error);return false}D=K?K.get_json(A,{no_id:true,no_data:true,no_state:true}):A;if(!D){return false}if(D.id===true){delete D.id}D=this._parse_model_from_json(D,I.id,I.parents.concat());if(!D){return false}H=this.get_node(D);if(A&&A.state&&A.state.loaded===false){H.state.loaded=false}w=[];w.push(D);w=w.concat(H.children_d);this.trigger("model",{nodes:w,parent:I.id});for(F=0,E=I.parents.length;F<E;F++){this._model.data[I.parents[F]].children_d=this._model.data[I.parents[F]].children_d.concat(w)}w=[];for(F=0,E=I.children.length;F<E;F++){w[F>=v?F+1:F]=I.children[F]}w[v]=H.id;I.children=w;I.children_d.push(H.id);I.children_d=I.children_d.concat(H.children_d);if(I.id===d.jstree.root){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(I.id)}if(!G){this.redraw(I.id===d.jstree.root)}if(u){u.call(this,H,I,v)}this.trigger("copy_node",{node:H,original:A,parent:I.id,position:v,old_parent:z,old_position:K&&K._id&&z&&K._model.data[z]&&K._model.data[z].children?d.inArray(A.id,K._model.data[z].children):-1,is_multi:(K&&K._id&&K._id!==this._id),is_foreign:(!K||!K._id),old_instance:K,new_instance:this});return H.id},cut:function(w){if(!w){w=this._data.core.selected.concat()}if(!d.isArray(w)){w=[w]}if(!w.length){return false}var t=[],x,v,u;for(v=0,u=w.length;v<u;v++){x=this.get_node(w[v]);if(x&&x.id&&x.id!==d.jstree.root){t.push(x)}}if(!t.length){return false}b=t;l=this;s="move_node";this.trigger("cut",{node:w})},copy:function(w){if(!w){w=this._data.core.selected.concat()}if(!d.isArray(w)){w=[w]}if(!w.length){return false}var t=[],x,v,u;for(v=0,u=w.length;v<u;v++){x=this.get_node(w[v]);if(x&&x.id&&x.id!==d.jstree.root){t.push(x)}}if(!t.length){return false}b=t;l=this;s="copy_node";this.trigger("copy",{node:w})},get_buffer:function(){return{mode:s,node:b,inst:l}},can_paste:function(){return s!==false&&b!==false},paste:function(t,u){t=this.get_node(t);if(!t||!s||!s.match(/^(copy_node|move_node)$/)||!b){return false}if(this[s](b,t,u,false,false,false,l)){this.trigger("paste",{parent:t.id,node:b,mode:s})}b=false;s=false;l=false},clear_buffer:function(){b=false;s=false;l=false;this.trigger("clear_buffer")},edit:function(v,B,E){var A,D,C,H,G,y,x,z,u,F=false;v=this.get_node(v);if(!v){return false}if(this.settings.core.check_callback===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"};this.settings.core.error.call(this,this._data.core.last_error);return false}u=v;B=typeof B==="string"?B:v.text;this.set_text(v,"");v=this._open_to(v);u.text=B;A=this._data.core.rtl;D=this.element.width();this._data.core.focused=u.id;C=v.children(".jstree-anchor").focus();H=d("<span>");
/*!
			oi = obj.children("i:visible"),
			ai = a.children("i:visible"),
			w1 = oi.width() * oi.length,
			w2 = ai.width() * ai.length,
			*/
G=B;y=d("<div />",{css:{position:"absolute",top:"-200px",left:(A?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body");x=d("<input />",{value:G,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:(this._data.core.li_height)+"px",lineHeight:(this._data.core.li_height)+"px",width:"150px"},blur:d.proxy(function(K){K.stopImmediatePropagation();K.preventDefault();var I=H.children(".jstree-rename-input"),w=I.val(),J=this.settings.core.force_text,t;if(w===""){w=G}y.remove();H.replaceWith(C);H.remove();G=J?G:d("<div></div>").append(d.parseHTML(G)).html();this.set_text(v,G);t=!!this.rename_node(v,J?d("<div></div>").text(w).text():d("<div></div>").append(d.parseHTML(w)).html());if(!t){this.set_text(v,G)}this._data.core.focused=u.id;setTimeout(d.proxy(function(){var L=this.get_node(u.id,true);if(L.length){this._data.core.focused=u.id;L.children(".jstree-anchor").focus()}},this),0);if(E){E.call(this,u,t,F)}x=null},this),keydown:function(w){var t=w.which;if(t===27){F=true;this.value=G}if(t===27||t===13||t===37||t===38||t===39||t===40||t===32){w.stopImmediatePropagation()}if(t===27||t===13){w.preventDefault();this.blur()}},click:function(t){t.stopImmediatePropagation()},mousedown:function(t){t.stopImmediatePropagation()},keyup:function(t){x.width(Math.min(y.text("pW"+this.value).width(),D))},keypress:function(t){if(t.which===13){return false}}});z={fontFamily:C.css("fontFamily")||"",fontSize:C.css("fontSize")||"",fontWeight:C.css("fontWeight")||"",fontStyle:C.css("fontStyle")||"",fontStretch:C.css("fontStretch")||"",fontVariant:C.css("fontVariant")||"",letterSpacing:C.css("letterSpacing")||"",wordSpacing:C.css("wordSpacing")||""};H.attr("class",C.attr("class")).append(C.contents().clone()).append(x);C.replaceWith(H);y.css(z);x.css(z).width(Math.min(y.text("pW"+x[0].value).width(),D))[0].select();d(o).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){if(x&&t.target!==x){d(x).blur()}})},set_theme:function(v,t){if(!v){return false}if(t===true){var u=this.settings.core.themes.dir;if(!u){u=d.jstree.path+"/themes"}t=u+"/"+v+"/style.css"}if(t&&d.inArray(t,p)===-1){d("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />');p.push(t)}if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)}this._data.core.themes.name=v;this.element.addClass("jstree-"+v);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+v+"-responsive");this.trigger("set_theme",{theme:v})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(t){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}this._data.core.themes.variant=t;if(t){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=true;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=false;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){if(this._data.core.themes.stripes){this.hide_stripes()}else{this.show_stripes()}},show_dots:function(){this._data.core.themes.dots=true;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=false;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){if(this._data.core.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this._data.core.themes.icons=true;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=false;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){if(this._data.core.themes.icons){this.hide_icons()}else{this.show_icons()}},set_icon:function(x,v){var w,u,y,t;if(d.isArray(x)){x=x.slice();for(w=0,u=x.length;w<u;w++){this.set_icon(x[w],v)}return true}x=this.get_node(x);if(!x||x.id===d.jstree.root){return false}t=x.icon;x.icon=v===true||v===null||v===e||v===""?true:v;y=this.get_node(x,true).children(".jstree-anchor").children(".jstree-themeicon");if(v===false){this.hide_icon(x)}else{if(v===true||v===null||v===e||v===""){y.removeClass("jstree-themeicon-custom "+t).css("background","").removeAttr("rel");if(t===false){this.show_icon(x)}}else{if(v.indexOf("/")===-1&&v.indexOf(".")===-1){y.removeClass(t).css("background","");y.addClass(v+" jstree-themeicon-custom").attr("rel",v);if(t===false){this.show_icon(x)}}else{y.removeClass(t).css("background","");y.addClass("jstree-themeicon-custom").css("background","url('"+v+"') center center no-repeat").attr("rel",v);if(t===false){this.show_icon(x)}}}}return true},get_icon:function(t){t=this.get_node(t);return(!t||t.id===d.jstree.root)?false:t.icon},hide_icon:function(v){var u,t;if(d.isArray(v)){v=v.slice();for(u=0,t=v.length;u<t;u++){this.hide_icon(v[u])}return true}v=this.get_node(v);if(!v||v===d.jstree.root){return false}v.icon=false;this.get_node(v,true).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return true},show_icon:function(v){var u,t,w;if(d.isArray(v)){v=v.slice();for(u=0,t=v.length;u<t;u++){this.show_icon(v[u])}return true}v=this.get_node(v);if(!v||v===d.jstree.root){return false}w=this.get_node(v,true);v.icon=w.length?w.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):true;if(!v.icon){v.icon=true}w.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return true}};d.vakata={};d.vakata.attributes=function(u,v){u=d(u)[0];var t=v?{}:[];if(u&&u.attributes){d.each(u.attributes,function(x,w){if(d.inArray(w.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return}if(w.value!==null&&d.trim(w.value)!==""){if(v){t[w.name]=w.value}else{t.push(w.name)}}})}return t};d.vakata.array_unique=function(y){var u=[],w,v,t,x={};for(w=0,t=y.length;w<t;w++){if(x[y[w]]===e){u.push(y[w]);x[y[w]]=true}}return u};d.vakata.array_remove=function(u,t){u.splice(t,1);return u};d.vakata.array_remove_item=function(v,u){var t=d.inArray(u,v);return t!==-1?d.vakata.array_remove(v,t):v};d.vakata.array_filter=function(x,u,t,w,v){if(x.filter){return x.filter(u,t)}w=[];for(v in x){if(~~v+""===v+""&&v>=0&&u.call(t,x[v],+v,x)){w.push(x[v])}}return w};d.jstree.plugins.changed=function(t,u){var v=[];this.trigger=function(z,A){var y,w;if(!A){A={}}if(z.replace(".jstree","")==="changed"){A.changed={selected:[],deselected:[]};var x={};for(y=0,w=v.length;y<w;y++){x[v[y]]=1}for(y=0,w=A.selected.length;y<w;y++){if(!x[A.selected[y]]){A.changed.selected.push(A.selected[y])}else{x[A.selected[y]]=2}}for(y=0,w=v.length;y<w;y++){if(x[v[y]]===1){A.changed.deselected.push(v[y])}}v=A.selected.slice()}u.trigger.call(this,z,A)};this.refresh=function(x,w){v=[];return u.refresh.apply(this,arguments)}};var a=o.createElement("I");a.className="jstree-icon jstree-checkbox";a.setAttribute("role","presentation");d.jstree.defaults.checkbox={visible:true,three_state:true,whole_node:true,keep_selected_style:true,cascade:"",tie_selection:true};d.jstree.plugins.checkbox=function(t,u){this.bind=function(){u.bind.call(this);this._data.checkbox.uto=false;this._data.checkbox.selected=[];if(this.settings.checkbox.three_state){this.settings.checkbox.cascade="up+down+undetermined"}this.element.on("init.jstree",d.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;if(!this.settings.checkbox.keep_selected_style){this.element.addClass("jstree-checkbox-no-clicked")}if(this.settings.checkbox.tie_selection){this.element.addClass("jstree-checkbox-selection")}},this)).on("loading.jstree",d.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.cascade.indexOf("undetermined")!==-1){this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",d.proxy(function(){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(d.proxy(this._undetermined,this),50)},this))}if(!this.settings.checkbox.tie_selection){this.element.on("model.jstree",d.proxy(function(A,y){var v=this._model.data,z=v[y.parent],B=y.nodes,x,w;for(x=0,w=B.length;x<w;x++){v[B[x]].state.checked=v[B[x]].state.checked||(v[B[x]].original&&v[B[x]].original.state&&v[B[x]].original.state.checked);if(v[B[x]].state.checked){this._data.checkbox.selected.push(B[x])}}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1){this.element.on("model.jstree",d.proxy(function(E,B){var w=this._model.data,v=w[B.parent],D=B.nodes,I=[],F,C,z,y,x,A,H=this.settings.checkbox.cascade,G=this.settings.checkbox.tie_selection;if(H.indexOf("down")!==-1){if(v.state[G?"selected":"checked"]){for(C=0,z=D.length;C<z;C++){w[D[C]].state[G?"selected":"checked"]=true}this._data[G?"core":"checkbox"].selected=this._data[G?"core":"checkbox"].selected.concat(D)}else{for(C=0,z=D.length;C<z;C++){if(w[D[C]].state[G?"selected":"checked"]){for(y=0,x=w[D[C]].children_d.length;y<x;y++){w[w[D[C]].children_d[y]].state[G?"selected":"checked"]=true}this._data[G?"core":"checkbox"].selected=this._data[G?"core":"checkbox"].selected.concat(w[D[C]].children_d)}}}}if(H.indexOf("up")!==-1){for(C=0,z=v.children_d.length;C<z;C++){if(!w[v.children_d[C]].children.length){I.push(w[v.children_d[C]].parent)}}I=d.vakata.array_unique(I);for(y=0,x=I.length;y<x;y++){v=w[I[y]];while(v&&v.id!==d.jstree.root){F=0;for(C=0,z=v.children.length;C<z;C++){F+=w[v.children[C]].state[G?"selected":"checked"]}if(F===z){v.state[G?"selected":"checked"]=true;this._data[G?"core":"checkbox"].selected.push(v.id);A=this.get_node(v,true);if(A&&A.length){A.attr("aria-selected",true).children(".jstree-anchor").addClass(G?"jstree-clicked":"jstree-checked")}}else{break}v=this.get_node(v.parent)}}}this._data[G?"core":"checkbox"].selected=d.vakata.array_unique(this._data[G?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",d.proxy(function(D,B){var A=B.node,w=this._model.data,E=this.get_node(A.parent),x=this.get_node(A,true),C,y,F,z,I=this.settings.checkbox.cascade,H=this.settings.checkbox.tie_selection,v={},G=this._data[H?"core":"checkbox"].selected;for(C=0,y=G.length;C<y;C++){v[G[C]]=true}if(I.indexOf("down")!==-1){for(C=0,y=A.children_d.length;C<y;C++){v[A.children_d[C]]=true;z=w[A.children_d[C]];z.state[H?"selected":"checked"]=true;if(z&&z.original&&z.original.state&&z.original.state.undetermined){z.original.state.undetermined=false}}}if(I.indexOf("up")!==-1){while(E&&E.id!==d.jstree.root){F=0;for(C=0,y=E.children.length;C<y;C++){F+=w[E.children[C]].state[H?"selected":"checked"]}if(F===y){E.state[H?"selected":"checked"]=true;v[E.id]=true;z=this.get_node(E,true);if(z&&z.length){z.attr("aria-selected",true).children(".jstree-anchor").addClass(H?"jstree-clicked":"jstree-checked")}}else{break}E=this.get_node(E.parent)}}G=[];for(C in v){if(v.hasOwnProperty(C)){G.push(C)}}this._data[H?"core":"checkbox"].selected=G;if(I.indexOf("down")!==-1&&x.length){x.find(".jstree-anchor").addClass(H?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",true)}},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",d.proxy(function(B,z){var A=this.get_node(d.jstree.root),v=this._model.data,y,w,x;for(y=0,w=A.children_d.length;y<w;y++){x=v[A.children_d[y]];if(x&&x.original&&x.original.state&&x.original.state.undetermined){x.original.state.undetermined=false}}},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",d.proxy(function(C,z){var y=z.node,w=this.get_node(y,true),A,x,B,F=this.settings.checkbox.cascade,E=this.settings.checkbox.tie_selection,D=this._data[E?"core":"checkbox"].selected,v={};if(y&&y.original&&y.original.state&&y.original.state.undetermined){y.original.state.undetermined=false}if(F.indexOf("down")!==-1){for(A=0,x=y.children_d.length;A<x;A++){B=this._model.data[y.children_d[A]];B.state[E?"selected":"checked"]=false;if(B&&B.original&&B.original.state&&B.original.state.undetermined){B.original.state.undetermined=false}}}if(F.indexOf("up")!==-1){for(A=0,x=y.parents.length;A<x;A++){B=this._model.data[y.parents[A]];B.state[E?"selected":"checked"]=false;if(B&&B.original&&B.original.state&&B.original.state.undetermined){B.original.state.undetermined=false}B=this.get_node(y.parents[A],true);if(B&&B.length){B.attr("aria-selected",false).children(".jstree-anchor").removeClass(E?"jstree-clicked":"jstree-checked")}}}v={};for(A=0,x=D.length;A<x;A++){if((F.indexOf("down")===-1||d.inArray(D[A],y.children_d)===-1)&&(F.indexOf("up")===-1||d.inArray(D[A],y.parents)===-1)){v[D[A]]=true}}D=[];for(A in v){if(v.hasOwnProperty(A)){D.push(A)}}this._data[E?"core":"checkbox"].selected=D;if(F.indexOf("down")!==-1&&w.length){w.find(".jstree-anchor").removeClass(E?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",false)}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1){this.element.on("delete_node.jstree",d.proxy(function(B,y){var v=this.get_node(y.parent),w=this._model.data,z,x,C,A,D=this.settings.checkbox.tie_selection;while(v&&v.id!==d.jstree.root&&!v.state[D?"selected":"checked"]){C=0;for(z=0,x=v.children.length;z<x;z++){C+=w[v.children[z]].state[D?"selected":"checked"]}if(x>0&&C===x){v.state[D?"selected":"checked"]=true;this._data[D?"core":"checkbox"].selected.push(v.id);A=this.get_node(v,true);if(A&&A.length){A.attr("aria-selected",true).children(".jstree-anchor").addClass(D?"jstree-clicked":"jstree-checked")}}else{break}v=this.get_node(v.parent)}},this)).on("move_node.jstree",d.proxy(function(E,C){var y=C.is_multi,D=C.old_parent,v=this.get_node(C.parent),x=this._model.data,w,F,B,z,A,G=this.settings.checkbox.tie_selection;if(!y){w=this.get_node(D);while(w&&w.id!==d.jstree.root&&!w.state[G?"selected":"checked"]){F=0;for(B=0,z=w.children.length;B<z;B++){F+=x[w.children[B]].state[G?"selected":"checked"]}if(z>0&&F===z){w.state[G?"selected":"checked"]=true;this._data[G?"core":"checkbox"].selected.push(w.id);A=this.get_node(w,true);if(A&&A.length){A.attr("aria-selected",true).children(".jstree-anchor").addClass(G?"jstree-clicked":"jstree-checked")}}else{break}w=this.get_node(w.parent)}}w=v;while(w&&w.id!==d.jstree.root){F=0;for(B=0,z=w.children.length;B<z;B++){F+=x[w.children[B]].state[G?"selected":"checked"]}if(F===z){if(!w.state[G?"selected":"checked"]){w.state[G?"selected":"checked"]=true;this._data[G?"core":"checkbox"].selected.push(w.id);A=this.get_node(w,true);if(A&&A.length){A.attr("aria-selected",true).children(".jstree-anchor").addClass(G?"jstree-clicked":"jstree-checked")}}}else{if(w.state[G?"selected":"checked"]){w.state[G?"selected":"checked"]=false;this._data[G?"core":"checkbox"].selected=d.vakata.array_remove_item(this._data[G?"core":"checkbox"].selected,w.id);A=this.get_node(w,true);if(A&&A.length){A.attr("aria-selected",false).children(".jstree-anchor").removeClass(G?"jstree-clicked":"jstree-checked")}}else{break}}w=this.get_node(w.parent)}},this))}};this._undetermined=function(){if(this.element===null){return}var B,A,z,y,w={},x=this._model.data,D=this.settings.checkbox.tie_selection,E=this._data[D?"core":"checkbox"].selected,v=[],C=this;for(B=0,A=E.length;B<A;B++){if(x[E[B]]&&x[E[B]].parents){for(z=0,y=x[E[B]].parents.length;z<y;z++){if(w[x[E[B]].parents[z]]!==e){break}if(x[E[B]].parents[z]!==d.jstree.root){w[x[E[B]].parents[z]]=true;v.push(x[E[B]].parents[z])}}}}this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var F=C.get_node(this),G;if(!F.state.loaded){if(F.original&&F.original.state&&F.original.state.undetermined&&F.original.state.undetermined===true){if(w[F.id]===e&&F.id!==d.jstree.root){w[F.id]=true;v.push(F.id)}for(z=0,y=F.parents.length;z<y;z++){if(w[F.parents[z]]===e&&F.parents[z]!==d.jstree.root){w[F.parents[z]]=true;v.push(F.parents[z])}}}}else{for(B=0,A=F.children_d.length;B<A;B++){G=x[F.children_d[B]];if(!G.state.loaded&&G.original&&G.original.state&&G.original.state.undetermined&&G.original.state.undetermined===true){if(w[G.id]===e&&G.id!==d.jstree.root){w[G.id]=true;v.push(G.id)}for(z=0,y=G.parents.length;z<y;z++){if(w[G.parents[z]]===e&&G.parents[z]!==d.jstree.root){w[G.parents[z]]=true;v.push(G.parents[z])}}}}}});this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");for(B=0,A=v.length;B<A;B++){if(!x[v[B]].state[D?"selected":"checked"]){E=this.get_node(v[B],true);if(E&&E.length){E.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}}}};this.redraw_node=function(C,v,z,B){C=u.redraw_node.apply(this,arguments);if(C){var y,w,x=null,A=null;for(y=0,w=C.childNodes.length;y<w;y++){if(C.childNodes[y]&&C.childNodes[y].className&&C.childNodes[y].className.indexOf("jstree-anchor")!==-1){x=C.childNodes[y];break}}if(x){if(!this.settings.checkbox.tie_selection&&this._model.data[C.id].state.checked){x.className+=" jstree-checked"}A=a.cloneNode(false);if(this._model.data[C.id].state.checkbox_disabled){A.className+=" jstree-checkbox-disabled"}x.insertBefore(A,x.childNodes[0])}}if(!z&&this.settings.checkbox.cascade.indexOf("undetermined")!==-1){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(d.proxy(this._undetermined,this),50)}return C};this.show_checkboxes=function(){this._data.core.themes.checkboxes=true;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=false;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){if(this._data.core.themes.checkboxes){this.hide_checkboxes()}else{this.show_checkboxes()}};this.is_undetermined=function(A){A=this.get_node(A);var z=this.settings.checkbox.cascade,y,w,x=this.settings.checkbox.tie_selection,B=this._data[x?"core":"checkbox"].selected,v=this._model.data;if(!A||A.state[x?"selected":"checked"]===true||z.indexOf("undetermined")===-1||(z.indexOf("down")===-1&&z.indexOf("up")===-1)){return false}if(!A.state.loaded&&A.original.state.undetermined===true){return true}for(y=0,w=A.children_d.length;y<w;y++){if(d.inArray(A.children_d[y],B)!==-1||(!v[A.children_d[y]].state.loaded&&v[A.children_d[y]].original.state.undetermined)){return true}}return false};this.disable_checkbox=function(x){var w,v,y;if(d.isArray(x)){x=x.slice();for(w=0,v=x.length;w<v;w++){this.disable_checkbox(x[w])}return true}x=this.get_node(x);if(!x||x.id===d.jstree.root){return false}y=this.get_node(x,true);if(!x.state.checkbox_disabled){x.state.checkbox_disabled=true;if(y&&y.length){y.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled")}this.trigger("disable_checkbox",{node:x})}};this.enable_checkbox=function(x){var w,v,y;if(d.isArray(x)){x=x.slice();for(w=0,v=x.length;w<v;w++){this.enable_checkbox(x[w])}return true}x=this.get_node(x);if(!x||x.id===d.jstree.root){return false}y=this.get_node(x,true);if(x.state.checkbox_disabled){x.state.checkbox_disabled=false;if(y&&y.length){y.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled")}this.trigger("enable_checkbox",{node:x})}};this.activate_node=function(w,v){if(d(v.target).hasClass("jstree-checkbox-disabled")){return false}if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||d(v.target).hasClass("jstree-checkbox"))){v.ctrlKey=true}if(this.settings.checkbox.tie_selection||(!this.settings.checkbox.whole_node&&!d(v.target).hasClass("jstree-checkbox"))){return u.activate_node.call(this,w,v)}if(this.is_disabled(w)){return false}if(this.is_checked(w)){this.uncheck_node(w,v)}else{this.check_node(w,v)}this.trigger("activate_node",{node:this.get_node(w)})};this.check_node=function(z,y){if(this.settings.checkbox.tie_selection){return this.select_node(z,false,true,y)}var A,x,v,w;if(d.isArray(z)){z=z.slice();for(x=0,v=z.length;x<v;x++){this.check_node(z[x],y)}return true}z=this.get_node(z);if(!z||z.id===d.jstree.root){return false}A=this.get_node(z,true);if(!z.state.checked){z.state.checked=true;this._data.checkbox.selected.push(z.id);if(A&&A.length){A.children(".jstree-anchor").addClass("jstree-checked")}this.trigger("check_node",{node:z,selected:this._data.checkbox.selected,event:y})}};this.uncheck_node=function(y,x){if(this.settings.checkbox.tie_selection){return this.deselect_node(y,false,x)}var w,v,z;if(d.isArray(y)){y=y.slice();for(w=0,v=y.length;w<v;w++){this.uncheck_node(y[w],x)}return true}y=this.get_node(y);if(!y||y.id===d.jstree.root){return false}z=this.get_node(y,true);if(y.state.checked){y.state.checked=false;this._data.checkbox.selected=d.vakata.array_remove_item(this._data.checkbox.selected,y.id);if(z.length){z.children(".jstree-anchor").removeClass("jstree-checked")}this.trigger("uncheck_node",{node:y,selected:this._data.checkbox.selected,event:x})}};this.check_all=function(){if(this.settings.checkbox.tie_selection){return this.select_all()}var x=this._data.checkbox.selected.concat([]),w,v;this._data.checkbox.selected=this._model.data[d.jstree.root].children_d.concat();for(w=0,v=this._data.checkbox.selected.length;w<v;w++){if(this._model.data[this._data.checkbox.selected[w]]){this._model.data[this._data.checkbox.selected[w]].state.checked=true}}this.redraw(true);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection){return this.deselect_all()}var x=this._data.checkbox.selected.concat([]),w,v;for(w=0,v=this._data.checkbox.selected.length;w<v;w++){if(this._model.data[this._data.checkbox.selected[w]]){this._model.data[this._data.checkbox.selected[w]].state.checked=false}}this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:x})};this.is_checked=function(v){if(this.settings.checkbox.tie_selection){return this.is_selected(v)}v=this.get_node(v);if(!v||v.id===d.jstree.root){return false}return v.state.checked};this.get_checked=function(v){if(this.settings.checkbox.tie_selection){return this.get_selected(v)}return v?d.map(this._data.checkbox.selected,d.proxy(function(w){return this.get_node(w)},this)):this._data.checkbox.selected};this.get_top_checked=function(A){if(this.settings.checkbox.tie_selection){return this.get_top_selected(A)}var z=this.get_checked(true),B={},y,x,w,v;for(y=0,x=z.length;y<x;y++){B[z[y].id]=z[y]}for(y=0,x=z.length;y<x;y++){for(w=0,v=z[y].children_d.length;w<v;w++){if(B[z[y].children_d[w]]){delete B[z[y].children_d[w]]}}}z=[];for(y in B){if(B.hasOwnProperty(y)){z.push(y)}}return A?d.map(z,d.proxy(function(C){return this.get_node(C)},this)):z};this.get_bottom_checked=function(y){if(this.settings.checkbox.tie_selection){return this.get_bottom_selected(y)}var x=this.get_checked(true),z=[],w,v;for(w=0,v=x.length;w<v;w++){if(!x[w].children.length){z.push(x[w].id)}}return y?d.map(z,d.proxy(function(A){return this.get_node(A)},this)):z};this.load_node=function(A,C){var w,v,z,x,B,y;if(!d.isArray(A)&&!this.settings.checkbox.tie_selection){y=this.get_node(A);if(y&&y.state.loaded){for(w=0,v=y.children_d.length;w<v;w++){if(this._model.data[y.children_d[w]].state.checked){B=true;this._data.checkbox.selected=d.vakata.array_remove_item(this._data.checkbox.selected,y.children_d[w])}}}}return u.load_node.apply(this,arguments)};this.get_state=function(){var v=u.get_state.apply(this,arguments);if(this.settings.checkbox.tie_selection){return v}v.checkbox=this._data.checkbox.selected.slice();return v};this.set_state=function(w,y){var v=u.set_state.apply(this,arguments);if(v&&w.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var x=this;d.each(w.checkbox,function(A,z){x.check_node(z)})}delete w.checkbox;this.set_state(w,y);return false}return v};this.refresh=function(w,v){if(!this.settings.checkbox.tie_selection){this._data.checkbox.selected=[]}return u.refresh.apply(this,arguments)}};d.jstree.defaults.conditionalselect=function(){return true};d.jstree.plugins.conditionalselect=function(t,u){this.activate_node=function(w,v){if(this.settings.conditionalselect.call(this,this.get_node(w),v)){u.activate_node.call(this,w,v)}}};d.jstree.defaults.dnd={copy:true,open_timeout:500,is_draggable:true,check_while_dragging:true,always_copy:false,inside_pos:0,drag_selection:true,touch:true,large_drop_target:false,large_drag_target:false,use_html5:false};var r,g;d.jstree.plugins.dnd=function(t,u){this.init=function(w,v){u.init.call(this,w,v);this.settings.dnd.use_html5=this.settings.dnd.use_html5&&("draggable" in o.createElement("span"))};this.bind=function(){u.bind.call(this);this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",d.proxy(function(y){if(this.settings.dnd.large_drag_target&&d(y.target).closest(".jstree-node")[0]!==y.currentTarget){return true}if(y.type==="touchstart"&&(!this.settings.dnd.touch||(this.settings.dnd.touch==="selected"&&!d(y.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))){return true}var x=this.get_node(y.target),w=this.is_selected(x)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,v=(w>1?w+" "+this.get_string("nodes"):this.get_text(y.currentTarget));if(this.settings.core.force_text){v=d.vakata.html.escape(v)}if(x&&x.id&&x.id!==d.jstree.root&&(y.which===1||y.type==="touchstart"||y.type==="dragstart")&&(this.settings.dnd.is_draggable===true||(d.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,(w>1?this.get_top_selected(true):[x]),y)))){r={jstree:true,origin:this,obj:this.get_node(x,true),nodes:w>1?this.get_top_selected():[x.id]};g=y.currentTarget;if(this.settings.dnd.use_html5){d.vakata.dnd._trigger("start",y,{helper:d(),element:g,data:r})}else{this.element.trigger("mousedown.jstree");return d.vakata.dnd.start(y,r,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+v+'<ins class="jstree-copy" style="display:none;">+</ins></div>')}}},this));if(this.settings.dnd.use_html5){this.element.on("dragover.jstree",function(v){v.preventDefault();d.vakata.dnd._trigger("move",v,{helper:d(),element:g,data:r});return false}).on("drop.jstree",d.proxy(function(v){v.preventDefault();d.vakata.dnd._trigger("stop",v,{helper:d(),element:g,data:r});return false},this))}};this.redraw_node=function(A,v,B,z){A=u.redraw_node.apply(this,arguments);if(A&&this.settings.dnd.use_html5){if(this.settings.dnd.large_drag_target){A.setAttribute("draggable",true)}else{var y,w,x=null;for(y=0,w=A.childNodes.length;y<w;y++){if(A.childNodes[y]&&A.childNodes[y].className&&A.childNodes[y].className.indexOf("jstree-anchor")!==-1){x=A.childNodes[y];break}}if(x){x.setAttribute("draggable",true)}}}return A}};d(function(){var x=false,w=false,u=false,v=false,t=d('<div id="jstree-marker">&#160;</div>').hide();d(o).on("dnd_start.vakata.jstree",function(z,y){x=false;u=false;if(!y||!y.data||!y.data.jstree){return}t.appendTo("body")}).on("dnd_move.vakata.jstree",function(Q,T){if(v){if(!T.event||T.event.type!=="dragover"||T.event.target!==u.target){clearTimeout(v)}}if(!T||!T.data||!T.data.jstree){return}if(T.event.target.id&&T.event.target.id==="jstree-marker"){return}u=T.event;var y=d.jstree.reference(T.event.target),C=false,S=false,z=false,R,N,I,P,J,O,K,H,G,F,E,L,M,D,A,B;if(y&&y._data&&y._data.dnd){t.attr("class","jstree-"+y.get_theme()+(y.settings.core.themes.responsive?" jstree-dnd-responsive":""));B=T.data.origin&&(T.data.origin.settings.dnd.always_copy||(T.data.origin.settings.dnd.copy&&(T.event.metaKey||T.event.ctrlKey)));T.helper.children().attr("class","jstree-"+y.get_theme()+" jstree-"+y.get_theme()+"-"+y.get_theme_variant()+" "+(y.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[B?"show":"hide"]();if((T.event.target===y.element[0]||T.event.target===y.get_container_ul()[0])&&y.get_container_ul().children().length===0){H=true;for(G=0,F=T.data.nodes.length;G<F;G++){H=H&&y.check((T.data.origin&&(T.data.origin.settings.dnd.always_copy||(T.data.origin.settings.dnd.copy&&(T.event.metaKey||T.event.ctrlKey)))?"copy_node":"move_node"),(T.data.origin&&T.data.origin!==y?T.data.origin.get_node(T.data.nodes[G]):T.data.nodes[G]),d.jstree.root,"last",{dnd:true,ref:y.get_node(d.jstree.root),pos:"i",origin:T.data.origin,is_multi:(T.data.origin&&T.data.origin!==y),is_foreign:(!T.data.origin)});if(!H){break}}if(H){x={ins:y,par:d.jstree.root,pos:"last"};t.hide();T.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(T.event.originalEvent&&T.event.originalEvent.dataTransfer){T.event.originalEvent.dataTransfer.dropEffect=B?"copy":"move"}return}}else{C=y.settings.dnd.large_drop_target?d(T.event.target).closest(".jstree-node").children(".jstree-anchor"):d(T.event.target).closest(".jstree-anchor");if(C&&C.length&&C.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){S=C.offset();z=(T.event.pageY!==e?T.event.pageY:T.event.originalEvent.pageY)-S.top;P=C.outerHeight();if(z<P/3){K=["b","i","a"]}else{if(z>P-P/3){K=["a","i","b"]}else{K=z>P/2?["i","a","b"]:["i","b","a"]}}d.each(K,function(V,U){switch(U){case"b":N=S.left-6;I=S.top;J=y.get_parent(C);O=C.parent().index();break;case"i":D=y.settings.dnd.inside_pos;A=y.get_node(C.parent());N=S.left-2;I=S.top+P/2+1;J=A.id;O=D==="first"?0:(D==="last"?A.children.length:Math.min(D,A.children.length));break;case"a":N=S.left-6;I=S.top+P;J=y.get_parent(C);O=C.parent().index()+1;break}H=true;for(G=0,F=T.data.nodes.length;G<F;G++){E=T.data.origin&&(T.data.origin.settings.dnd.always_copy||(T.data.origin.settings.dnd.copy&&(T.event.metaKey||T.event.ctrlKey)))?"copy_node":"move_node";L=O;if(E==="move_node"&&U==="a"&&(T.data.origin&&T.data.origin===y)&&J===y.get_parent(T.data.nodes[G])){M=y.get_node(J);if(L>d.inArray(T.data.nodes[G],M.children)){L-=1}}H=H&&((y&&y.settings&&y.settings.dnd&&y.settings.dnd.check_while_dragging===false)||y.check(E,(T.data.origin&&T.data.origin!==y?T.data.origin.get_node(T.data.nodes[G]):T.data.nodes[G]),J,L,{dnd:true,ref:y.get_node(C.parent()),pos:U,origin:T.data.origin,is_multi:(T.data.origin&&T.data.origin!==y),is_foreign:(!T.data.origin)}));if(!H){if(y&&y.last_error){w=y.last_error()}break}}if(U==="i"&&C.parent().is(".jstree-closed")&&y.settings.dnd.open_timeout){v=setTimeout((function(W,X){return function(){W.open_node(X)}}(y,C)),y.settings.dnd.open_timeout)}if(H){x={ins:y,par:J,pos:U==="i"&&D==="last"&&O===0&&!y.is_loaded(A)?"last":O};t.css({left:N+"px",top:I+"px"}).show();T.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(T.event.originalEvent&&T.event.originalEvent.dataTransfer){T.event.originalEvent.dataTransfer.dropEffect=B?"copy":"move"}w={};K=true;return false}});if(K===true){return}}}}x=false;T.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");if(T.event.originalEvent&&T.event.originalEvent.dataTransfer){T.event.originalEvent.dataTransfer.dropEffect="none"}t.hide()}).on("dnd_scroll.vakata.jstree",function(z,y){if(!y||!y.data||!y.data.jstree){return}t.hide();x=false;u=false;y.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er")}).on("dnd_stop.vakata.jstree",function(C,B){if(v){clearTimeout(v)}if(!B||!B.data||!B.data.jstree){return}t.hide().detach();var A,z,y=[];if(x){for(A=0,z=B.data.nodes.length;A<z;A++){y[A]=B.data.origin?B.data.origin.get_node(B.data.nodes[A]):B.data.nodes[A]}x.ins[B.data.origin&&(B.data.origin.settings.dnd.always_copy||(B.data.origin.settings.dnd.copy&&(B.event.metaKey||B.event.ctrlKey)))?"copy_node":"move_node"](y,x.par,x.pos,false,false,false,B.data.origin)}else{A=d(B.event.target).closest(".jstree");if(A.length&&w&&w.error&&w.error==="check"){A=A.jstree(true);if(A){A.settings.core.error.call(this,w)}}}u=false;x=false}).on("keyup.jstree keydown.jstree",function(z,y){y=d.vakata.dnd._get();if(y&&y.data&&y.data.jstree){if(z.type==="keyup"&&z.which===27){if(v){clearTimeout(v)}x=false;w=false;u=false;v=false;t.hide().detach();d.vakata.dnd._clean()}else{y.helper.find(".jstree-copy").first()[y.data.origin&&(y.data.origin.settings.dnd.always_copy||(y.data.origin.settings.dnd.copy&&(z.metaKey||z.ctrlKey)))?"show":"hide"]();if(u){u.metaKey=z.metaKey;u.ctrlKey=z.ctrlKey;d.vakata.dnd._trigger("move",u)}}}})});(function(u){u.vakata.html={div:u("<div />"),escape:function(v){return u.vakata.html.div.text(v).html()},strip:function(v){return u.vakata.html.div.empty().append(u.parseHTML(v)).text()}};var t={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};u.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(x,w,v){if(v===e){v=u.vakata.dnd._get()}v.event=w;u(o).triggerHandler("dnd_"+x+".vakata",v)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){if(t.helper){t.helper.remove()}if(t.scroll_i){clearInterval(t.scroll_i);t.scroll_i=false}t={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};u(o).off("mousemove.vakata.jstree touchmove.vakata.jstree",u.vakata.dnd.drag);u(o).off("mouseup.vakata.jstree touchend.vakata.jstree",u.vakata.dnd.stop)},_scroll:function(x){if(!t.scroll_e||(!t.scroll_l&&!t.scroll_t)){if(t.scroll_i){clearInterval(t.scroll_i);t.scroll_i=false}return false}if(!t.scroll_i){t.scroll_i=setInterval(u.vakata.dnd._scroll,100);return false}if(x===true){return false}var w=t.scroll_e.scrollTop(),v=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(w+t.scroll_t*u.vakata.dnd.settings.scroll_speed);t.scroll_e.scrollLeft(v+t.scroll_l*u.vakata.dnd.settings.scroll_speed);if(w!==t.scroll_e.scrollTop()||v!==t.scroll_e.scrollLeft()){u.vakata.dnd._trigger("scroll",t.scroll_e)}},start:function(x,w,v){if(x.type==="touchstart"&&x.originalEvent&&x.originalEvent.changedTouches&&x.originalEvent.changedTouches[0]){x.pageX=x.originalEvent.changedTouches[0].pageX;x.pageY=x.originalEvent.changedTouches[0].pageY;x.target=o.elementFromPoint(x.originalEvent.changedTouches[0].pageX-window.pageXOffset,x.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(t.is_drag){u.vakata.dnd.stop({})}try{x.currentTarget.unselectable="on";x.currentTarget.onselectstart=function(){return false};if(x.currentTarget.style){x.currentTarget.style.touchAction="none";x.currentTarget.style.msTouchAction="none";x.currentTarget.style.MozUserSelect="none"}}catch(y){}t.init_x=x.pageX;t.init_y=x.pageY;t.data=w;t.is_down=true;t.element=x.currentTarget;t.target=x.target;t.is_touch=x.type==="touchstart";if(v!==false){t.helper=u("<div id='vakata-dnd'></div>").html(v).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})}u(o).on("mousemove.vakata.jstree touchmove.vakata.jstree",u.vakata.dnd.drag);u(o).on("mouseup.vakata.jstree touchend.vakata.jstree",u.vakata.dnd.stop);return false},drag:function(C){if(C.type==="touchmove"&&C.originalEvent&&C.originalEvent.changedTouches&&C.originalEvent.changedTouches[0]){C.pageX=C.originalEvent.changedTouches[0].pageX;C.pageY=C.originalEvent.changedTouches[0].pageY;C.target=o.elementFromPoint(C.originalEvent.changedTouches[0].pageX-window.pageXOffset,C.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(!t.is_down){return}if(!t.is_drag){if(Math.abs(C.pageX-t.init_x)>(t.is_touch?u.vakata.dnd.settings.threshold_touch:u.vakata.dnd.settings.threshold)||Math.abs(C.pageY-t.init_y)>(t.is_touch?u.vakata.dnd.settings.threshold_touch:u.vakata.dnd.settings.threshold)){if(t.helper){t.helper.appendTo("body");t.helper_w=t.helper.outerWidth()}t.is_drag=true;u.vakata.dnd._trigger("start",C)}else{return}}var D=false,G=false,E=false,x=false,v=false,A=false,z=false,B=false,F=false,y=false;t.scroll_t=0;t.scroll_l=0;t.scroll_e=false;u(u(C.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return(/^auto|scroll$/).test(u(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var w=u(this),H=w.offset();if(this.scrollHeight>this.offsetHeight){if(H.top+w.height()-C.pageY<u.vakata.dnd.settings.scroll_proximity){t.scroll_t=1}if(C.pageY-H.top<u.vakata.dnd.settings.scroll_proximity){t.scroll_t=-1}}if(this.scrollWidth>this.offsetWidth){if(H.left+w.width()-C.pageX<u.vakata.dnd.settings.scroll_proximity){t.scroll_l=1}if(C.pageX-H.left<u.vakata.dnd.settings.scroll_proximity){t.scroll_l=-1}}if(t.scroll_t||t.scroll_l){t.scroll_e=u(this);return false}});if(!t.scroll_e){D=u(o);G=u(window);E=D.height();x=G.height();v=D.width();A=G.width();z=D.scrollTop();B=D.scrollLeft();if(E>x&&C.pageY-z<u.vakata.dnd.settings.scroll_proximity){t.scroll_t=-1}if(E>x&&x-(C.pageY-z)<u.vakata.dnd.settings.scroll_proximity){t.scroll_t=1}if(v>A&&C.pageX-B<u.vakata.dnd.settings.scroll_proximity){t.scroll_l=-1}if(v>A&&A-(C.pageX-B)<u.vakata.dnd.settings.scroll_proximity){t.scroll_l=1}if(t.scroll_t||t.scroll_l){t.scroll_e=D}}if(t.scroll_e){u.vakata.dnd._scroll(true)}if(t.helper){F=parseInt(C.pageY+u.vakata.dnd.settings.helper_top,10);y=parseInt(C.pageX+u.vakata.dnd.settings.helper_left,10);if(E&&F+25>E){F=E-50}if(v&&y+t.helper_w>v){y=v-(t.helper_w+2)}t.helper.css({left:y+"px",top:F+"px"})}u.vakata.dnd._trigger("move",C);return false},stop:function(v){if(v.type==="touchend"&&v.originalEvent&&v.originalEvent.changedTouches&&v.originalEvent.changedTouches[0]){v.pageX=v.originalEvent.changedTouches[0].pageX;v.pageY=v.originalEvent.changedTouches[0].pageY;v.target=o.elementFromPoint(v.originalEvent.changedTouches[0].pageX-window.pageXOffset,v.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(t.is_drag){u.vakata.dnd._trigger("stop",v)}else{if(v.type==="touchend"&&v.target===t.target){var w=setTimeout(function(){u(v.target).click()},100);u(v.target).one("click",function(){if(w){clearTimeout(w)}})}}u.vakata.dnd._clean();return false}}}(d));d.jstree.defaults.massload=null;d.jstree.plugins.massload=function(t,u){this.init=function(w,v){this._data.massload={};u.init.call(this,w,v)};this._load_nodes=function(w,E,D,C){var F=this.settings.massload,v=JSON.stringify(w),x=[],y=this._model.data,B,A,z;if(!D){for(B=0,A=w.length;B<A;B++){if(!y[w[B]]||((!y[w[B]].state.loaded&&!y[w[B]].state.failed)||C)){x.push(w[B]);z=this.get_node(w[B],true);if(z&&z.length){z.addClass("jstree-loading").attr("aria-busy",true)}}}this._data.massload={};if(x.length){if(d.isFunction(F)){return F.call(this,x,d.proxy(function(I){var H,G;if(I){for(H in I){if(I.hasOwnProperty(H)){this._data.massload[H]=I[H]}}}for(H=0,G=w.length;H<G;H++){z=this.get_node(w[H],true);if(z&&z.length){z.removeClass("jstree-loading").attr("aria-busy",false)}}u._load_nodes.call(this,w,E,D,C)},this))}if(typeof F==="object"&&F&&F.url){F=d.extend(true,{},F);if(d.isFunction(F.url)){F.url=F.url.call(this,x)}if(d.isFunction(F.data)){F.data=F.data.call(this,x)}return d.ajax(F).done(d.proxy(function(K,J,G){var I,H;if(K){for(I in K){if(K.hasOwnProperty(I)){this._data.massload[I]=K[I]}}}for(I=0,H=w.length;I<H;I++){z=this.get_node(w[I],true);if(z&&z.length){z.removeClass("jstree-loading").attr("aria-busy",false)}}u._load_nodes.call(this,w,E,D,C)},this)).fail(d.proxy(function(G){u._load_nodes.call(this,w,E,D,C)},this))}}}return u._load_nodes.call(this,w,E,D,C)};this._load_node=function(x,z){var w=this._data.massload[x.id],v=null,y;if(w){v=this[typeof w==="string"?"_append_html_data":"_append_json_data"](x,typeof w==="string"?d(d.parseHTML(w)).filter(function(){return this.nodeType!==3}):w,function(A){z.call(this,A)});y=this.get_node(x.id,true);if(y&&y.length){y.removeClass("jstree-loading").attr("aria-busy",false)}delete this._data.massload[x.id];return v}return u._load_node.call(this,x,z)}};d.jstree.defaults.search={ajax:false,fuzzy:false,case_sensitive:false,show_only_matches:false,show_only_matches_children:false,close_opened_onclear:true,search_leaves_only:false,search_callback:false};d.jstree.plugins.search=function(t,u){this.bind=function(){u.bind.call(this);this._data.search.str="";this._data.search.dom=d();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=false;this._data.search.smc=false;this._data.search.hdn=[];this.element.on("search.jstree",d.proxy(function(C,A){if(this._data.search.som&&A.res.length){var v=this._model.data,z,y,B=[],x,w;for(z=0,y=A.res.length;z<y;z++){if(v[A.res[z]]&&!v[A.res[z]].state.hidden){B.push(A.res[z]);B=B.concat(v[A.res[z]].parents);if(this._data.search.smc){for(x=0,w=v[A.res[z]].children_d.length;x<w;x++){if(v[v[A.res[z]].children_d[x]]&&!v[v[A.res[z]].children_d[x]].state.hidden){B.push(v[A.res[z]].children_d[x])}}}}}B=d.vakata.array_remove_item(d.vakata.array_unique(B),d.jstree.root);this._data.search.hdn=this.hide_all(true);this.show_node(B,true);this.redraw(true)}},this)).on("clear_search.jstree",d.proxy(function(w,v){if(this._data.search.som&&v.res.length){this.show_node(this._data.search.hdn,true);this.redraw(true)}},this))};this.search=function(F,H,y,A,x,B){if(F===false||d.trim(F.toString())===""){return this.clear_search()}A=this.get_node(A);A=A&&A.id?A.id:null;F=F.toString();var I=this.settings.search,G=I.ajax?I.ajax:false,z=this._model.data,E=null,v=[],w=[],D,C;if(this._data.search.res.length&&!x){this.clear_search()}if(y===e){y=I.show_only_matches}if(B===e){B=I.show_only_matches_children}if(!H&&G!==false){if(d.isFunction(G)){return G.call(this,F,d.proxy(function(J){if(J&&J.d){J=J.d}this._load_nodes(!d.isArray(J)?[]:d.vakata.array_unique(J),function(){this.search(F,true,y,A,x)})},this),A)}else{G=d.extend({},G);if(!G.data){G.data={}}G.data.str=F;if(A){G.data.inside=A}return d.ajax(G).fail(d.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(G)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done(d.proxy(function(J){if(J&&J.d){J=J.d}this._load_nodes(!d.isArray(J)?[]:d.vakata.array_unique(J),function(){this.search(F,true,y,A,x)})},this))}}if(!x){this._data.search.str=F;this._data.search.dom=d();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=y;this._data.search.smc=B}E=new d.vakata.search(F,true,{caseSensitive:I.case_sensitive,fuzzy:I.fuzzy});d.each(z[A?A:d.jstree.root].children_d,function(L,K){var J=z[K];if(J.text&&!J.state.hidden&&(!I.search_leaves_only||(J.state.loaded&&J.children.length===0))&&((I.search_callback&&I.search_callback.call(this,F,J))||(!I.search_callback&&E.search(J.text).isMatch))){v.push(K);w=w.concat(J.parents)}});if(v.length){w=d.vakata.array_unique(w);for(D=0,C=w.length;D<C;D++){if(w[D]!==d.jstree.root&&z[w[D]]&&this.open_node(w[D],null,0)===true){this._data.search.opn.push(w[D])}}if(!x){this._data.search.dom=d(this.element[0].querySelectorAll("#"+d.map(v,function(J){return"0123456789".indexOf(J[0])!==-1?"\\3"+J[0]+" "+J.substr(1).replace(d.jstree.idregex,"\\$&"):J.replace(d.jstree.idregex,"\\$&")}).join(", #")));this._data.search.res=v}else{this._data.search.dom=this._data.search.dom.add(d(this.element[0].querySelectorAll("#"+d.map(v,function(J){return"0123456789".indexOf(J[0])!==-1?"\\3"+J[0]+" "+J.substr(1).replace(d.jstree.idregex,"\\$&"):J.replace(d.jstree.idregex,"\\$&")}).join(", #"))));this._data.search.res=d.vakata.array_unique(this._data.search.res.concat(v))}this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:F,res:this._data.search.res,show_only_matches:y})};this.clear_search=function(){if(this.settings.search.close_opened_onclear){this.close_node(this._data.search.opn,0)}this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});if(this._data.search.res.length){this._data.search.dom=d(this.element[0].querySelectorAll("#"+d.map(this._data.search.res,function(w){return"0123456789".indexOf(w[0])!==-1?"\\3"+w[0]+" "+w.substr(1).replace(d.jstree.idregex,"\\$&"):w.replace(d.jstree.idregex,"\\$&")}).join(", #")));this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")}this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=d()};this.redraw_node=function(A,v,B,z){A=u.redraw_node.apply(this,arguments);if(A){if(d.inArray(A.id,this._data.search.res)!==-1){var y,w,x=null;for(y=0,w=A.childNodes.length;y<w;y++){if(A.childNodes[y]&&A.childNodes[y].className&&A.childNodes[y].className.indexOf("jstree-anchor")!==-1){x=A.childNodes[y];break}}if(x){x.className+=" jstree-search"}}}return A}};(function(t){t.vakata.search=function(z,x,E){E=E||{};E=t.extend({},t.vakata.search.defaults,E);if(E.fuzzy!==false){E.fuzzy=true}z=E.caseSensitive?z:z.toLowerCase();var B=E.location,C=E.distance,A=E.threshold,u=z.length,v,w,y,D;if(u>32){E.fuzzy=false}if(E.fuzzy){v=1<<(u-1);w=(function(){var F={},G=0;for(G=0;G<u;G++){F[z.charAt(G)]=0}for(G=0;G<u;G++){F[z.charAt(G)]|=1<<(u-G-1)}return F}());y=function(I,F){var H=I/u,G=Math.abs(B-F);if(!C){return G?1:H}return H+(G/C)}}D=function(S){S=E.caseSensitive?S:S.toLowerCase();if(z===S||S.indexOf(z)!==-1){return{isMatch:true,score:0}}if(!E.fuzzy){return{isMatch:false,score:1}}var N,M,R=S.length,J=A,L=S.indexOf(z,B),P,I,G=u+R,F,H,Q,U,T,K=1,O=[];if(L!==-1){J=Math.min(y(0,L),J);L=S.lastIndexOf(z,B+u);if(L!==-1){J=Math.min(y(0,L),J)}}L=-1;for(N=0;N<u;N++){P=0;I=G;while(P<I){if(y(N,B+I)<=J){P=I}else{G=I}I=Math.floor((G-P)/2+P)}G=I;H=Math.max(1,B-I+1);Q=Math.min(B+I,R)+u;U=new Array(Q+2);U[Q+1]=(1<<N)-1;for(M=Q;M>=H;M--){T=w[S.charAt(M-1)];if(N===0){U[M]=((U[M+1]<<1)|1)&T}else{U[M]=((U[M+1]<<1)|1)&T|(((F[M+1]|F[M])<<1)|1)|F[M+1]}if(U[M]&v){K=y(N,M-1);if(K<=J){J=K;L=M-1;O.push(L);if(L>B){H=Math.max(1,2*B-L)}else{break}}}}if(y(N+1,B)>J){break}F=U}return{isMatch:L>=0,score:K}};return x===true?{search:D}:D(x)};t.vakata.search.defaults={location:0,distance:100,threshold:0.6,fuzzy:false,caseSensitive:false}}(d));d.jstree.defaults.sort=function(u,t){return this.get_text(u)>this.get_text(t)?1:-1};d.jstree.plugins.sort=function(t,u){this.bind=function(){u.bind.call(this);this.element.on("model.jstree",d.proxy(function(w,v){this.sort(v.parent,true)},this)).on("rename_node.jstree create_node.jstree",d.proxy(function(w,v){this.sort(v.parent||v.node.parent,false);this.redraw_node(v.parent||v.node.parent,true)},this)).on("move_node.jstree copy_node.jstree",d.proxy(function(w,v){this.sort(v.parent,false);this.redraw_node(v.parent,true)},this))};this.sort=function(y,v){var x,w;y=this.get_node(y);if(y&&y.children&&y.children.length){y.children.sort(d.proxy(this.settings.sort,this));if(v){for(x=0,w=y.children_d.length;x<w;x++){this.sort(y.children_d[x],false)}}}}};var c=false;d.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:false,filter:false};d.jstree.plugins.state=function(t,u){this.bind=function(){u.bind.call(this);var v=d.proxy(function(){this.element.on(this.settings.state.events,d.proxy(function(){if(c){clearTimeout(c)}c=setTimeout(d.proxy(function(){this.save_state()},this),100)},this));this.trigger("state_ready")},this);this.element.on("ready.jstree",d.proxy(function(x,w){this.element.one("restore_state.jstree",v);if(!this.restore_state()){v()}},this))};this.save_state=function(){var v={state:this.get_state(),ttl:this.settings.state.ttl,sec:+(new Date())};d.vakata.storage.set(this.settings.state.key,JSON.stringify(v))};this.restore_state=function(){var v=d.vakata.storage.get(this.settings.state.key);if(!!v){try{v=JSON.parse(v)}catch(w){return false}}if(!!v&&v.ttl&&v.sec&&+(new Date())-v.sec>v.ttl){return false}if(!!v&&v.state){v=v.state}if(!!v&&d.isFunction(this.settings.state.filter)){v=this.settings.state.filter.call(this,v)}if(!!v){this.element.one("set_state.jstree",function(y,x){x.instance.trigger("restore_state",{state:d.extend(true,{},v)})});this.set_state(v);return true}return false};this.clear_state=function(){return d.vakata.storage.del(this.settings.state.key)}};(function(t,u){t.vakata.storage={set:function(v,w){return window.localStorage.setItem(v,w)},get:function(v){return window.localStorage.getItem(v)},del:function(v){return window.localStorage.removeItem(v)}}}(d));d.jstree.defaults.types={"default":{}};d.jstree.defaults.types[d.jstree.root]={};d.jstree.plugins.types=function(t,u){this.init=function(y,w){var x,v;if(w&&w.types&&w.types["default"]){for(x in w.types){if(x!=="default"&&x!==d.jstree.root&&w.types.hasOwnProperty(x)){for(v in w.types["default"]){if(w.types["default"].hasOwnProperty(v)&&w.types[x][v]===e){w.types[x][v]=w.types["default"][v]}}}}}u.init.call(this,y,w);this._model.data[d.jstree.root].type=d.jstree.root};this.refresh=function(w,v){u.refresh.call(this,w,v);this._model.data[d.jstree.root].type=d.jstree.root};this.bind=function(){this.element.on("model.jstree",d.proxy(function(B,y){var v=this._model.data,A=y.nodes,D=this.settings.types,z,x,C="default",w;for(z=0,x=A.length;z<x;z++){C="default";if(v[A[z]].original&&v[A[z]].original.type&&D[v[A[z]].original.type]){C=v[A[z]].original.type}if(v[A[z]].data&&v[A[z]].data.jstree&&v[A[z]].data.jstree.type&&D[v[A[z]].data.jstree.type]){C=v[A[z]].data.jstree.type}v[A[z]].type=C;if(v[A[z]].icon===true&&D[C].icon!==e){v[A[z]].icon=D[C].icon}if(D[C].li_attr!==e&&typeof D[C].li_attr==="object"){for(w in D[C].li_attr){if(D[C].li_attr.hasOwnProperty(w)){if(w==="id"){continue}else{if(v[A[z]].li_attr[w]===e){v[A[z]].li_attr[w]=D[C].li_attr[w]}else{if(w==="class"){v[A[z]].li_attr["class"]=D[C].li_attr["class"]+" "+v[A[z]].li_attr["class"]}}}}}}if(D[C].a_attr!==e&&typeof D[C].a_attr==="object"){for(w in D[C].a_attr){if(D[C].a_attr.hasOwnProperty(w)){if(w==="id"){continue}else{if(v[A[z]].a_attr[w]===e){v[A[z]].a_attr[w]=D[C].a_attr[w]}else{if(w==="href"&&v[A[z]].a_attr[w]==="#"){v[A[z]].a_attr.href=D[C].a_attr.href}else{if(w==="class"){v[A[z]].a_attr["class"]=D[C].a_attr["class"]+" "+v[A[z]].a_attr["class"]}}}}}}}}v[d.jstree.root].type=d.jstree.root},this));u.bind.call(this)};this.get_json=function(B,x,C){var A,w,v=this._model.data,z=x?d.extend(true,{},x,{no_id:false}):{},y=u.get_json.call(this,B,z,C);if(y===false){return false}if(d.isArray(y)){for(A=0,w=y.length;A<w;A++){y[A].type=y[A].id&&v[y[A].id]&&v[y[A].id].type?v[y[A].id].type:"default";if(x&&x.no_id){delete y[A].id;if(y[A].li_attr&&y[A].li_attr.id){delete y[A].li_attr.id}if(y[A].a_attr&&y[A].a_attr.id){delete y[A].a_attr.id}}}}else{y.type=y.id&&v[y.id]&&v[y.id].type?v[y.id].type:"default";if(x&&x.no_id){y=this._delete_ids(y)}}return y};this._delete_ids=function(x){if(d.isArray(x)){for(var w=0,v=x.length;w<v;w++){x[w]=this._delete_ids(x[w])}return x}delete x.id;if(x.li_attr&&x.li_attr.id){delete x.li_attr.id}if(x.a_attr&&x.a_attr.id){delete x.a_attr.id}if(x.children&&d.isArray(x.children)){x.children=this._delete_ids(x.children)}return x};this.check=function(D,y,B,E,C){if(u.check.call(this,D,y,B,E,C)===false){return false}y=y&&y.id?y:this.get_node(y);B=B&&B.id?B:this.get_node(B);var v=y&&y.id?(C&&C.origin?C.origin:d.jstree.reference(y.id)):null,z,A,x,w;v=v&&v._model&&v._model.data?v._model.data:null;switch(D){case"create_node":case"move_node":case"copy_node":if(D!=="move_node"||d.inArray(y.id,B.children)===-1){z=this.get_rules(B);if(z.max_children!==e&&z.max_children!==-1&&z.max_children===B.children.length){this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+D,data:JSON.stringify({chk:D,pos:E,obj:y&&y.id?y.id:false,par:B&&B.id?B.id:false})};return false}if(z.valid_children!==e&&z.valid_children!==-1&&d.inArray((y.type||"default"),z.valid_children)===-1){this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+D,data:JSON.stringify({chk:D,pos:E,obj:y&&y.id?y.id:false,par:B&&B.id?B.id:false})};return false}if(v&&y.children_d&&y.parents){A=0;for(x=0,w=y.children_d.length;x<w;x++){A=Math.max(A,v[y.children_d[x]].parents.length)}A=A-y.parents.length+1}if(A<=0||A===e){A=1}do{if(z.max_depth!==e&&z.max_depth!==-1&&z.max_depth<A){this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+D,data:JSON.stringify({chk:D,pos:E,obj:y&&y.id?y.id:false,par:B&&B.id?B.id:false})};return false}B=this.get_node(B.parent);z=this.get_rules(B);A++}while(B)}break}return true};this.get_rules=function(w){w=this.get_node(w);if(!w){return false}var v=this.get_type(w,true);if(v.max_depth===e){v.max_depth=-1}if(v.max_children===e){v.max_children=-1}if(v.valid_children===e){v.valid_children=-1}return v};this.get_type=function(v,w){v=this.get_node(v);return(!v)?false:(w?d.extend({type:v.type},this.settings.types[v.type]):v.type)};this.set_type=function(x,B){var v=this._model.data,F,z,y,D,E,w,A,C;if(d.isArray(x)){x=x.slice();for(z=0,y=x.length;z<y;z++){this.set_type(x[z],B)}return true}F=this.settings.types;x=this.get_node(x);if(!F[B]||!x){return false}A=this.get_node(x,true);if(A&&A.length){C=A.children(".jstree-anchor")}D=x.type;E=this.get_icon(x);x.type=B;if(E===true||(F[D]&&F[D].icon!==e&&E===F[D].icon)){this.set_icon(x,F[B].icon!==e?F[B].icon:true)}if(F[D].li_attr!==e&&typeof F[D].li_attr==="object"){for(w in F[D].li_attr){if(F[D].li_attr.hasOwnProperty(w)){if(w==="id"){continue}else{if(w==="class"){v[x.id].li_attr["class"]=(v[x.id].li_attr["class"]||"").replace(F[D].li_attr[w],"");if(A){A.removeClass(F[D].li_attr[w])}}else{if(v[x.id].li_attr[w]===F[D].li_attr[w]){v[x.id].li_attr[w]=null;if(A){A.removeAttr(w)}}}}}}}if(F[D].a_attr!==e&&typeof F[D].a_attr==="object"){for(w in F[D].a_attr){if(F[D].a_attr.hasOwnProperty(w)){if(w==="id"){continue}else{if(w==="class"){v[x.id].a_attr["class"]=(v[x.id].a_attr["class"]||"").replace(F[D].a_attr[w],"");if(C){C.removeClass(F[D].a_attr[w])}}else{if(v[x.id].a_attr[w]===F[D].a_attr[w]){if(w==="href"){v[x.id].a_attr[w]="#";if(C){C.attr("href","#")}}else{delete v[x.id].a_attr[w];if(C){C.removeAttr(w)}}}}}}}}if(F[B].li_attr!==e&&typeof F[B].li_attr==="object"){for(w in F[B].li_attr){if(F[B].li_attr.hasOwnProperty(w)){if(w==="id"){continue}else{if(v[x.id].li_attr[w]===e){v[x.id].li_attr[w]=F[B].li_attr[w];if(A){if(w==="class"){A.addClass(F[B].li_attr[w])}else{A.attr(w,F[B].li_attr[w])}}}else{if(w==="class"){v[x.id].li_attr["class"]=F[B].li_attr[w]+" "+v[x.id].li_attr["class"];if(A){A.addClass(F[B].li_attr[w])}}}}}}}if(F[B].a_attr!==e&&typeof F[B].a_attr==="object"){for(w in F[B].a_attr){if(F[B].a_attr.hasOwnProperty(w)){if(w==="id"){continue}else{if(v[x.id].a_attr[w]===e){v[x.id].a_attr[w]=F[B].a_attr[w];if(C){if(w==="class"){C.addClass(F[B].a_attr[w])}else{C.attr(w,F[B].a_attr[w])}}}else{if(w==="href"&&v[x.id].a_attr[w]==="#"){v[x.id].a_attr.href=F[B].a_attr.href;if(C){C.attr("href",F[B].a_attr.href)}}else{if(w==="class"){v[x.id].a_attr["class"]=F[B].a_attr["class"]+" "+v[x.id].a_attr["class"];if(C){C.addClass(F[B].a_attr[w])}}}}}}}}return true}};d.jstree.defaults.unique={case_sensitive:false,duplicate:function(u,t){return u+" ("+t+")"}};d.jstree.plugins.unique=function(t,u){this.check=function(D,z,A,E,B){if(u.check.call(this,D,z,A,E,B)===false){return false}z=z&&z.id?z:this.get_node(z);A=A&&A.id?A:this.get_node(A);if(!A||!A.children){return true}var v=D==="rename_node"?E:z.text,C=[],F=this.settings.unique.case_sensitive,w=this._model.data,y,x;for(y=0,x=A.children.length;y<x;y++){C.push(F?w[A.children[y]].text:w[A.children[y]].text.toLowerCase())}if(!F){v=v.toLowerCase()}switch(D){case"delete_node":return true;case"rename_node":y=(d.inArray(v,C)===-1||(z.text&&z.text[F?"toString":"toLowerCase"]()===v));if(!y){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+v+" already exists. Preventing: "+D,data:JSON.stringify({chk:D,pos:E,obj:z&&z.id?z.id:false,par:A&&A.id?A.id:false})}}return y;case"create_node":y=(d.inArray(v,C)===-1);if(!y){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+v+" already exists. Preventing: "+D,data:JSON.stringify({chk:D,pos:E,obj:z&&z.id?z.id:false,par:A&&A.id?A.id:false})}}return y;case"copy_node":y=(d.inArray(v,C)===-1);if(!y){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+v+" already exists. Preventing: "+D,data:JSON.stringify({chk:D,pos:E,obj:z&&z.id?z.id:false,par:A&&A.id?A.id:false})}}return y;case"move_node":y=((z.parent===A.id&&(!B||!B.is_multi))||d.inArray(v,C)===-1);if(!y){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+v+" already exists. Preventing: "+D,data:JSON.stringify({chk:D,pos:E,obj:z&&z.id?z.id:false,par:A&&A.id?A.id:false})}}return y}return true};this.create_node=function(D,x,F,G,E){if(!x||x.text===e){if(D===null){D=d.jstree.root}D=this.get_node(D);if(!D){return u.create_node.call(this,D,x,F,G,E)}F=F===e?"last":F;if(!F.toString().match(/^(before|after)$/)&&!E&&!this.is_loaded(D)){return u.create_node.call(this,D,x,F,G,E)}if(!x){x={}}var B,v,C,A,z,w=this._model.data,H=this.settings.unique.case_sensitive,y=this.settings.unique.duplicate;v=B=this.get_string("New node");C=[];for(A=0,z=D.children.length;A<z;A++){C.push(H?w[D.children[A]].text:w[D.children[A]].text.toLowerCase())}A=1;while(d.inArray(H?v:v.toLowerCase(),C)!==-1){v=y.call(this,B,(++A)).toString()}x.text=v}return u.create_node.call(this,D,x,F,G,E)}};var j=o.createElement("DIV");j.setAttribute("unselectable","on");j.setAttribute("role","presentation");j.className="jstree-wholerow";j.innerHTML="&#160;";d.jstree.plugins.wholerow=function(t,u){this.bind=function(){u.bind.call(this);this.element.on("ready.jstree set_state.jstree",d.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",d.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",d.proxy(function(w,v){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",d.proxy(function(z,y){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var x=false,w,v;for(w=0,v=y.selected.length;w<v;w++){x=this.get_node(y.selected[w],true);if(x&&x.length){x.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}}},this)).on("open_node.jstree",d.proxy(function(w,v){this.get_node(v.node,true).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",d.proxy(function(w,v){if(w.type==="hover_node"&&this.is_disabled(v.node)){return}this.get_node(v.node,true).children(".jstree-wholerow")[w.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this))
/*!
				.on("mousedown.jstree touchstart.jstree", ".jstree-wholerow", function (e) {
						if(e.target === e.currentTarget) {
							var a = $(e.currentTarget).closest(".jstree-node").children(".jstree-anchor");
							e.target = a[0];
							a.trigger(e);
						}
					})
				*/
.on("click.jstree",".jstree-wholerow",function(w){w.stopImmediatePropagation();var v=d.Event("click",{metaKey:w.metaKey,ctrlKey:w.ctrlKey,altKey:w.altKey,shiftKey:w.shiftKey});d(w.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(v).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",d.proxy(function(w){w.stopImmediatePropagation();var v=d.Event("click",{metaKey:w.metaKey,ctrlKey:w.ctrlKey,altKey:w.altKey,shiftKey:w.shiftKey});d(w.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(v).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",d.proxy(function(v){v.stopImmediatePropagation();if(!this.is_disabled(v.currentTarget)){this.hover_node(v.currentTarget)}return false},this)).on("mouseleave.jstree",".jstree-node",d.proxy(function(v){this.dehover_node(v.currentTarget)},this))};this.teardown=function(){if(this.settings.wholerow){this.element.find(".jstree-wholerow").remove()}u.teardown.call(this)};this.redraw_node=function(y,v,z,x){y=u.redraw_node.apply(this,arguments);if(y){var w=j.cloneNode(true);if(d.inArray(y.id,this._data.core.selected)!==-1){w.className+=" jstree-wholerow-clicked"}if(this._data.core.focused&&this._data.core.focused===y.id){w.className+=" jstree-wholerow-hovered"}y.insertBefore(w,y.childNodes[0])}return y}};if(o.registerElement&&Object&&Object.create){var n=Object.create(HTMLElement.prototype);n.createdCallback=function(){var u={core:{},plugins:[]},t;for(t in d.jstree.plugins){if(d.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]){u.plugins.push(t);if(this.getAttribute(t)&&JSON.parse(this.getAttribute(t))){u[t]=JSON.parse(this.getAttribute(t))}}}for(t in d.jstree.defaults.core){if(d.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]){u.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t)}}d(this).jstree(u)};try{o.registerElement("vakata-jstree",{prototype:n})}catch(q){}}}));